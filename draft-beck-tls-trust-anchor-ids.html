<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>TLS Trust Anchor Identifiers</title>
<meta content="Bob Beck" name="author">
<meta content="David Benjamin" name="author">
<meta content="Devon O'Brien" name="author">
<meta content="
       This document defines the TLS Trust Anchors extension, a mechanism for relying parties and subscribers to convey trusted certification authorities. It describes individual certification authorities more succinctly than the TLS Certificate Authorities extension. 
       Additionally, to support TLS clients with many trusted certification authorities, it supports a mode where servers describe their available certification paths and the client selects from them. Servers may describe this during connection setup, or in DNS for lower latency. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="draft-beck-tls-trust-anchor-ids-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-beck-tls-trust-anchor-ids.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TLS Trust Anchor Identifiers</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Beck, et al.</td>
<td class="center">Expires 24 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-beck-tls-trust-anchor-ids-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-23" class="published">23 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-24">24 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Beck</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">D. Benjamin</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">D. O'Brien</div>
<div class="org">Google LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">TLS Trust Anchor Identifiers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the TLS Trust Anchors extension, a mechanism for relying parties and subscribers to convey trusted certification authorities. It describes individual certification authorities more succinctly than the TLS Certificate Authorities extension.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Additionally, to support TLS clients with many trusted certification authorities, it supports a mode where servers describe their available certification paths and the client selects from them. Servers may describe this during connection setup, or in DNS for lower latency.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://davidben.github.io/tls-trust-expressions/draft-beck-tls-trust-anchor-ids.html">https://davidben.github.io/tls-trust-expressions/draft-beck-tls-trust-anchor-ids.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-beck-tls-trust-anchor-ids/">https://datatracker.ietf.org/doc/draft-beck-tls-trust-anchor-ids/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Layer Security Working Group mailing list (<span><a href="mailto:tls@ietf.org">mailto:tls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tls/">https://www.ietf.org/mailman/listinfo/tls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/davidben/tls-trust-expressions">https://github.com/davidben/tls-trust-expressions</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology-and-roles" class="internal xref">Terminology and Roles</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-trust-anchor-identifiers" class="internal xref">Trust Anchor Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-relying-party-configuration" class="internal xref">Relying Party Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-subscriber-configuration" class="internal xref">Subscriber Configuration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-tls-extension" class="internal xref">TLS Extension</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-certificate-selection" class="internal xref">Certificate Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-retry-mechanism" class="internal xref">Retry Mechanism</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dns-service-parameter" class="internal xref">DNS Service Parameter</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-syntax" class="internal xref">Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-configuring-services" class="internal xref">Configuring Services</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-client-behavior" class="internal xref">Client Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acme-extension" class="internal xref">ACME Extension</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-relying-parties" class="internal xref">Relying Parties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-subscribers" class="internal xref">Subscribers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-relying-party-policies-and-" class="internal xref">Relying Party Policies and Agility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-incorrect-selection-metadat" class="internal xref">Incorrect Selection Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-serving-multiple-certificat" class="internal xref">Serving Multiple Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-targeting-tls-interception" class="internal xref">Targeting TLS Interception</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-tls-extensiontype-updates" class="internal xref">TLS ExtensionType Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-certificatepropertytype-reg" class="internal xref">CertificatePropertyType Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-comparison-to-tls-trust-exp" class="internal xref">Comparison to TLS Trust Expressions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> endpoints typically authenticate using X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. These are assertions by a certification authority (CA) that associate a TLS key with DNS names or other identifiers. If the peer trusts the CA, it will accept this association. The authenticating party (usually the server) is known as the <em>subscriber</em> and the peer (usually the client) is the <em>relying party</em>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.4" class="relref">Section 4.2.4</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> defines the <code>certificate_authorities</code> extension, which allows the subscriber, who may have multiple certificates available, to select the correct certificate for the relying party. However, this extension’s size is impractical for some applications.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Without such a negotiation mechanism, the subscriber must somehow obtain certificates which simultaneously satisfy all relying parties. This is a challenge for subscribers when relying parties are diverse. This translates to analogous challenges for CAs and relying parties:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">For a new CA to be usable by subscribers, all relying parties must trust it. This is particularly challenging for older, un-updatable relying parties. Existing CAs face similar challenges when rotating or deploying new keys.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">When a relying party must update its policies to meet new security requirements, it must choose between compromising on user security or imposing a significant burden on subscribers that still support older relying parties.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">The <code>certificate_authorities</code> extension’s size becomes impractical due to two factors. First, X.509 names are large. Second, many clients, notably web browsers, trust a large number of CAs. As of August 2023, the Mozilla CA Certificate Program <span>[<a href="#MOZILLA-ROOTS" class="cite xref">MOZILLA-ROOTS</a>]</span> contained 144 CAs, with an average name length of around 100 bytes. This document introduces Trust Anchor Identifiers, which aims to address both of these challenges.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">There are four parts to this mechanism:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-7">
<li id="section-1-7.1">
          <p id="section-1-7.1.1"><a href="#trust-anchor-ids" class="auto internal xref">Section 3</a> defines <em>trust anchor identifiers</em>, which are short, unique identifiers for X.509 trust anchors.<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-7.2">
          <p id="section-1-7.2.1"><a href="#tls-extension" class="auto internal xref">Section 4</a> defines a TLS extension that communicates the relying party’s requested trust anchors, and the subscriber’s available ones. When the relying party is a TLS client, it can mitigate large lists by sending a, possibly empty, subset of its trust anchors to the TLS server. The server provides its list of available trust anchors in response so that the client can retry on mismatch.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-7.3">
          <p id="section-1-7.3.1"><a href="#dns-service-parameter" class="auto internal xref">Section 5</a> allows TLS servers to advertise their available trust anchors in HTTPS or SVCB <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> DNS records. TLS clients can then request an accurate initial subset and avoid a retry penalty.<a href="#section-1-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-7.4">
          <p id="section-1-7.4.1"><a href="#acme-extension" class="auto internal xref">Section 6</a> defines an ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> extension for provisioning multiple certification paths, each with an associated trust anchor identifier.<a href="#section-1-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-8">Together, they extend the <code>certificate_authorities</code> mechanism to a broader set of applications, enabling a more flexible and robust PKI.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
when, and only when, they appear in all capitaIs, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document additionally uses the TLS presentation language, defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, and ASN.1, defined in <span>[<a href="#X680" class="cite xref">X680</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="terminology-and-roles">
<section id="section-2.1">
        <h3 id="name-terminology-and-roles">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology-and-roles" class="section-name selfRef">Terminology and Roles</a>
        </h3>
<p id="section-2.1-1">This document discusses three roles:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Subscriber:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The party whose identity is being validated in the protocol. In TLS, this is the side sending the Certificate and CertificateVerify message.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">Relying party:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">The party authenticating the subscriber. In TLS, this is the side that validates a Certificate and CertificateVerify message.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">Certification authority (CA):</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">The service issuing certificates to the subscriber.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-3">Additionally, there are several terms used throughout this document to describe this proposal:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">Trust anchor:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">A pre-distributed public key or certificate that relying parties use to determine whether a certification path is trusted.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.3">Certification path:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.4">
            <p id="section-2.1-4.4.1">An ordered list of X.509 certificates starting with the target certificate. Each certificate is issued by the next certificate, except the last, which is issued by a trust anchor.<a href="#section-2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="trust-anchor-ids">
<section id="section-3">
      <h2 id="name-trust-anchor-identifiers">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-trust-anchor-identifiers" class="section-name selfRef">Trust Anchor Identifiers</a>
      </h2>
<p id="section-3-1">This section defines trust anchor identifiers, which are short, unique identifiers for a trust anchor. To simplify allocation, these identifiers are defined with object identifiers (OIDs) <span>[<a href="#X680" class="cite xref">X680</a>]</span> and IANA-registered Private Enterprise Numbers (PENs) <span>[<a href="#RFC9371" class="cite xref">RFC9371</a>]</span>:<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">A trust anchor identifier is defined with a OID under the OID arc of some PEN. For compactness, they are represented as relative object identifiers (see Section 33 of <span>[<a href="#X680" class="cite xref">X680</a>]</span>), relative to the OID prefix <code>1.3.6.1.4.1</code>. For example, an organization with PEN 32473 might define a trust anchor identifier with the OID <code>1.3.6.1.4.1.32473.1</code>. As a relative object identifier, it would be the OID <code>32473.1</code>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Depending on the protocol, trust anchor identifiers may be represented in one of three ways:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">For use in ASN.1-based protocols, a trust anchor identifier's ASN.1 representation is the relative object identifier described above. This may be encoded in DER <span>[<a href="#X690" class="cite xref">X690</a>]</span>, or some other ASN.1 encoding. The example identifier's DER encoding is the six-octet sequence <code>{0x0d, 0x04, 0x81, 0xfd, 0x59, 0x01}</code>.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.2">
          <p id="section-3-4.2.1">For use in binary protocols such as TLS, a trust anchor identifier's binary representation consists of the contents octets of the relative object identifier's DER encoding, as described in Section 8.20 of <span>[<a href="#X690" class="cite xref">X690</a>]</span>. Note this omits the tag and length portion of the encoding. The example identifier's binary representation is the four-octet sequence <code>{0x81, 0xfd, 0x59, 0x01}</code>.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.3">
          <p id="section-3-4.3.1">For use in ASCII-compatible text protocols, a trust anchor identifier's ASCII representation is the relative object identifier in dotted decimal notation. The example identifier's ASCII representation is <code>32473.1</code>.<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-5">Trust anchor identifiers SHOULD be allocated by the CA operator and common among relying parties that trust the CA. They MAY be allocated by another party, e.g. when bootstrapping an existing ecosystem, if all parties agree on the identifier. In particular, the protocol requires relying parties and subscribers to agree, and subscriber configuration typically comes from the CA.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="relying-party-configuration">
<section id="section-3.1">
        <h3 id="name-relying-party-configuration">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-relying-party-configuration" class="section-name selfRef">Relying Party Configuration</a>
        </h3>
<p id="section-3.1-1">Relying parties are configured with one or more supported trust anchors. Each trust anchor which participates in this protocol must have an associated trust anchor identifier.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">When trust anchors are self-signed X.509 certificates, the X.509 trust anchor identifier extension MAY be used to carry this identifier. The trust anchor identifier extension has an <code>extnID</code> of <code>id-trustAnchorIdentifier</code> and an <code>extnValue</code> containing a DER-encoded TrustAnchorIdentifier structure, defined below. The TrustAnchorIdentifier is the trust anchor identifier's ASN.1 representation, described in <a href="#trust-anchor-ids" class="auto internal xref">Section 3</a>. This extension MUST be non-critical.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-3">
<pre>
id-trustAnchorIdentifier OBJECT IDENTIFIER ::= { TBD }

TrustAnchorIdentifier ::= RELATIVE-OID
</pre><a href="#section-3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1-4">Relying parties MAY instead or additionally configure trust anchor identifiers via some application-specific out-of-band information.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Relying parties MAY support trust anchors without associated trust anchor identifiers, but such trust anchors will not participate in this protocol. Those trust anchors MAY participate in other trust anchor negotiation protocols, such as the <code>certificate_authorities</code> extension.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscriber-configuration">
<section id="section-3.2">
        <h3 id="name-subscriber-configuration">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-subscriber-configuration" class="section-name selfRef">Subscriber Configuration</a>
        </h3>
<p id="section-3.2-1">Subscribers are configured with one or more candidate certification paths to present in TLS, in some preference order. This preference order is used when multiple candidate paths are usable for a connection. For example, the subscriber may prefer candidates that minimize message size or have more performant private keys.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Each candidate path which participates in this protocol must be provisioned with the trust anchor identifier for its corresponding trust anchor.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">To carry this information, this document defines the <code>trust_anchor_identifier</code> property for a CertificatePropertyList <span><a href="https://datatracker.ietf.org/doc/html/draft-davidben-tls-trust-expr-04#section-5" class="relref">Section 5</a> of [<a href="#I-D.davidben-tls-trust-expr" class="cite xref">I-D.davidben-tls-trust-expr</a>]</span>. This <code>data</code> field of the property contains the binary representation of the trust anchor identifier of the certification path’s trust anchor, as described in <a href="#trust-anchor-ids" class="auto internal xref">Section 3</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-4">
<pre>
enum {
    trust_anchor_identifier(TBD), (2^16-1)
} CertificatePropertyType;
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2-5">Subscribers MAY have candidate certification paths without associated trust anchor identifiers, but such paths will not participate in this protocol. Those paths MAY participate in other trust anchor negotiation protocols, such as the <code>certificate_authorities</code> extension.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">[[TODO: Move the definition of CertificatePropertyList from the trust expressions draft to here, if this ends up being the canonical one. When doing so, also import media type definition.]]<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tls-extension">
<section id="section-4">
      <h2 id="name-tls-extension">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-tls-extension" class="section-name selfRef">TLS Extension</a>
      </h2>
<p id="section-4-1">This section defines the <code>trust_anchors</code> extension, which is sent in the ClientHello, EncryptedExtensions, CertificateRequest, and Certificate messages in TLS 1.3 or later.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1">The <code>trust_anchors</code> extension is defined using the structures below:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
enum { trust_anchors(TBD), (2^16-1) } ExtensionType;

opaque TrustAnchorIdentifier&lt;1..2^8-1&gt;;

TrustAnchorIdentifier TrustAnchorIdentifierList&lt;0..2^16-1&gt;;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">When the extension is sent in the ClientHello or CertificateRequest messages, the <code>extension_data</code> is a TrustAnchorIdentifierList and indicates that the sender supports the specified trust anchors. The list is unordered, and MAY be empty. Each TrustAnchorIdentifier uses the binary representation, as described in <a href="#trust-anchor-ids" class="auto internal xref">Section 3</a>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">When the extension is sent in EncryptedExtensions, the <code>extension_data</code> is a TrustAnchorIdentifierList containing the list of trust anchors that server has available, in the server’s preference order, and MUST NOT be empty.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">When the extension is sent in Certificate, the <code>extension_data</code> MUST be empty and indicates that the sender sent the certificate because the certificate matched a trust anchor identifier sent by the peer. When used in this form, the extension may only be sent in the first CertificateEntry. It MUST NOT be sent in subsequent ones.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-selection">
<section id="section-4.2">
        <h3 id="name-certificate-selection">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-certificate-selection" class="section-name selfRef">Certificate Selection</a>
        </h3>
<p id="section-4.2-1">A <code>trust_anchors</code> extension in the ClientHello or CertificateRequest is processed similarly to the <code>certificate_authorities</code> extension. The relying party indicates some set of supported trust anchors in the ClientHello or CertificateRequest <code>trust_anchors</code> extension. The subscriber then selects a certificate from its candidate certification paths (see <a href="#subscriber-configuration" class="auto internal xref">Section 3.2</a>), as described in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.2" class="relref">Section 4.4.2.2</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.3" class="relref">Section 4.4.2.3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>. This process is extended as follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">If the ClientHello or CertificateRequest contains a <code>trust_anchors</code> extension, the subscriber SHOULD send a certification path whose trust anchor identifier appears in the relying party’s <code>trust_anchors</code> extension.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">If the ClientHello or CertificateRequest contains both <code>trust_anchors</code> and <code>certificate_authorities</code>, certification paths that satisfy either extension’s criteria may be used. This additionally applies to future extensions which play a similar role.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">If no certification paths satisfy either extension, the subscriber MAY return a <code>handshake_failure</code> alert, or choose among fallback certification paths without considering <code>trust_anchors</code> or <code>certification_authorities</code>. See <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a> for additional guidance on selecting a fallback when the ClientHello contains <code>trust_anchors</code>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">Sending a fallback allows the subscriber to retain support for relying parties that do not implement any form of trust anchor negotiation. In this case, the subscriber must find a sufficiently ubiquitous trust anchor, if one exists. However, only those relying parties need to be considered in this ubiquity determination. Updated relying parties may continue to evolve without restricting fallback certificate selection.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">If the subscriber sends a certification path that matches the relying party’s <code>trust_anchors</code> extension, as described in <a href="#certificate-selection" class="auto internal xref">Section 4.2</a>, the subscriber MUST send an empty <code>trust_anchors</code> extension in the first CertificateEntry of the Certificate message. In this case, the <code>certificate_list</code> flexibility described in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> no longer applies. The <code>certificate_list</code> MUST contain a complete certification path, issued by the matching trust anchor, correctly ordered and with no extraneous certificates. That is, each certificate MUST certify the one immediately preceding it, and the trust anchor MUST certify the final certificate. The subscriber MUST NOT send the <code>trust_anchors</code> extension in the Certificate message in other situations.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">If a relying party receives this extension in the Certificate message, it MAY choose to disable path building <span>[<a href="#RFC4158" class="cite xref">RFC4158</a>]</span> and validate the peer's certificate list as pre-built certification path. Doing so avoids the unpredictable behavior of path-building, and helps ensure CAs and subscribers do not inadvertently provision incorrect paths.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retry-mechanism">
<section id="section-4.3">
        <h3 id="name-retry-mechanism">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-retry-mechanism" class="section-name selfRef">Retry Mechanism</a>
        </h3>
<p id="section-4.3-1">When the relying party is a client, it may choose not to send its full trust anchor identifier list due to fingerprinting risks (see <a href="#privacy-considerations" class="auto internal xref">Section 8</a>), or because the list is too large. The client MAY send a subset of supported trust anchors, or an empty list. This subset may be determined by, possibly outdated, prior knowledge about the server, such as <a href="#dns-service-parameter" class="auto internal xref">Section 5</a> or past connections.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">To accommodate this, when receiving a ClientHello with <code>trust_anchors</code>, the server collects all candidate certification paths which:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">Have a trust anchor identifier, and<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">Satisfy the conditions in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.2" class="relref">Section 4.4.2.2</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, with the exception of <code>certification_authorities</code>, and any future extensions that play a similar role<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-4">If this collection is non-empty, the server sends a <code>trust_anchors</code> extension in EncryptedExtensions, containing the corresponding trust anchor identifiers in preference order.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">When a client sends a subset or empty list in <code>trust_anchors</code>, it SHOULD implement the following retry mechanism:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">If the client receives either a connection error or an untrusted certificate, the client looks in server’s EncryptedExtensions for a trust anchor identifier that it trusts. If there are multiple, it selects an option based on the server’s preference order and its local preferences. It then makes a new connection to the same endpoint, sending only the selected trust anchor identifier in the ClientHello <code>trust_anchors</code> extension. If the EncryptedExtensions had no <code>trust_anchor</code> extension, or no match was found, the client returns the error to the application.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Clients SHOULD retry at most once per connection attempt.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">[[TODO: Retrying in a new connection is expensive and cannot be done from within the TLS stack in most implementations. Consider handshake modifications to instead retry within the same connection.]]<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">This mechanism allows the connection to recover from a certificate selection failure, e.g. due to the client not revealing its full preference list, at additional latency cost. <a href="#dns-service-parameter" class="auto internal xref">Section 5</a> describes an optimization which can avoid this cost.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">This mechanism also allows servers to safely send fallback certificates that may not be as ubiquitously acceptable. Without some form of trust anchor negotiation, servers are limited to selecting certification paths that are ubiquitously trusted in all supported clients. This often means sending extra cross-certificates to target the lowest common denominator at a bandwidth cost. If the ClientHello contains <code>trust_anchors</code>, the server MAY opportunistically send a less ubiquitous, more bandwidth-efficient path based on local heuristics, with the expectation that the client will retry when the heuristics fail.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dns-service-parameter">
<section id="section-5">
      <h2 id="name-dns-service-parameter">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dns-service-parameter" class="section-name selfRef">DNS Service Parameter</a>
      </h2>
<p id="section-5-1">This section defines the <code>tls-trust-anchors</code> SvcParamKey <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>. TLS servers can use this to advertise their available trust anchors in DNS, and aid the client in formulating its <code>trust_anchors</code> extension (see <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a>). This allows TLS deployments to support clients with many trust anchors without incurring the overhead of a reconnect.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="syntax">
<section id="section-5.1">
        <h3 id="name-syntax">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
        </h3>
<p id="section-5.1-1">The <code>tls-trust-anchors</code> parameter contains an ordered list of one or more trust anchor identifiers, in server preference order.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The presentation <code>value</code> of the SvcParamValue is a non-empty comma-separated list (<span><a href="https://rfc-editor.org/rfc/rfc9460#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>). Each element of the list is a trust anchor identifier in the ASCII representation defined in <a href="#trust-anchor-ids" class="auto internal xref">Section 3</a>. Any other <code>value</code> is a syntax error. To enable simpler parsing, this SvcParam MUST NOT contain escape sequences.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The wire format of the SvcParamValue is determined by prefixing each trust anchor identifier with its length as a single octet, then concatenating each of these length-value pairs to form the SvcParamValue. These pairs MUST exactly fill the SvcParamValue; otherwise, the SvcParamValue is malformed.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">For example, if a TLS server has three available certification paths issued by <code>32473.1</code>, <code>32473.2.1</code>, and <code>32473.2.2</code>, respectively, the DNS record in presentation syntax may be:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="lang-dns sourcecode" id="section-5.1-5">
<pre>
example.net.  7200  IN SVCB 3 server.example.net. (
    tls-trust-anchors=32473.1,32473.2.1,32473.2.2 )
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">The wire format of the SvcParamValue would be the 17 octets below. In the example, the octets comprising each trust anchor identifier are placed on separate lines for clarity<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-7">
<pre>
0x04, 0x81, 0xfd, 0x59, 0x01,
0x05, 0x81, 0xfd, 0x59, 0x02, 0x01,
0x05, 0x81, 0xfd, 0x59, 0x02, 0x02,
</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="configuring-services">
<section id="section-5.2">
        <h3 id="name-configuring-services">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-configuring-services" class="section-name selfRef">Configuring Services</a>
        </h3>
<p id="section-5.2-1">Services SHOULD include the trust anchor identifier for each of their available certification paths, in preference order, in the <code>tls-trust-anchors</code> of their HTTPS or SVCB endpoints. As TLS configuration is updated, services SHOULD update the DNS record to match. The mechanism for this is out of scope for this document, but services are RECOMMENDED to automate this process.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Services MAY have certification paths without trust anchor identifiers, but those paths will not participate in this mechanism.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-behavior">
<section id="section-5.3">
        <h3 id="name-client-behavior">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-client-behavior" class="section-name selfRef">Client Behavior</a>
        </h3>
<p id="section-5.3-1">When connecting to a service endpoint whose HTTPS or SVCB record contains the <code>tls-trust-anchors</code> parameter, the client first computes the intersection between its configured trust anchors and the server’s provided list. If this intersection is non-empty, the client MAY use it to determine the <code>trust_anchors</code> extension in the ClientHello (see <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a>).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">If doing so, the client MAY send a subset of this intersection to meet size constraints, but SHOULD offer multiple options. This reduces the chance of a reconnection if, for example, the first option in the intersection uses a signature algorithm that the client doesn’t support, or if the TLS server and DNS configuration are out of sync.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Although this service parameter is intended to reduce trust anchor mismatches, mismatches may still occur in some scenarios. Clients and servers MUST continue to implement the provisions described in <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a>, even when using this service parameter.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acme-extension">
<section id="section-6">
      <h2 id="name-acme-extension">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acme-extension" class="section-name selfRef">ACME Extension</a>
      </h2>
<p id="section-6-1">We reuse the ACME extension defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-davidben-tls-trust-expr-04#section-7" class="relref">Section 7</a> of [<a href="#I-D.davidben-tls-trust-expr" class="cite xref">I-D.davidben-tls-trust-expr</a>]</span>, except that each CertificatePropertyList will contain a <code>trust_anchor_identifier</code> property.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">[[TODO: Move this over from the trust expressions draft, if this ends up being the canonical one.]]<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-7">
      <h2 id="name-use-cases">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="section-7-1">See <span><a href="https://datatracker.ietf.org/doc/html/draft-davidben-tls-trust-expr-04#section-9" class="relref">Section 9</a> of [<a href="#I-D.davidben-tls-trust-expr" class="cite xref">I-D.davidben-tls-trust-expr</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">[[TODO: Move the text here if this document ends up being the canonical one.]]<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="relying-parties">
<section id="section-8.1">
        <h3 id="name-relying-parties">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-relying-parties" class="section-name selfRef">Relying Parties</a>
        </h3>
<p id="section-8.1-1">The negotiation mechanism described in this document is analogous to the <code>certificate_authorities</code> extension (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.4" class="relref">Section 4.2.4</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>), but more size-efficient. Like that extension, it presumes the requested trust anchor list is not sensitive.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The privacy implications of this are determined by how a relying party uses this extension. Trust anchors supported by a relying party may be divided into three categories:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.1-3">
<li id="section-8.1-3.1">
            <p id="section-8.1-3.1.1">Trust anchors whose identifiers the relying party sends <em>unconditionally</em>, i.e. not in response to the server’s HTTPS/SVCB record, trust anchor list in EncryptedExtensions, etc.<a href="#section-8.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.1-3.2">
            <p id="section-8.1-3.2.1">Trust anchors whose identifiers the relying party sends <em>conditionally</em>, i.e. only if the server offers them. For example, the relying party may indicate support for a trust anchor if its identifier is listed in the server’s HTTPS/SVCB record or trust anchor list in EncryptedExtensions.<a href="#section-8.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.1-3.3">
            <p id="section-8.1-3.3.1">Trust anchors whose identifiers the relying party never sends, but still trusts. These are trust anchors which do not participate in this mechanism.<a href="#section-8.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-8.1-4">Each of these categories carries a different fingerprinting exposure:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">Trust anchor identifiers sent unconditionally can be observed passively. Thus, relying parties SHOULD NOT unconditionally advertise trust anchor lists which are unique to an individual user. Rather, such lists SHOULD be either empty or computed only from the trust anchors common to the relying party's anonymity set (<span><a href="https://rfc-editor.org/rfc/rfc6973#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>).<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">Trust anchor identifiers sent in response to the subscriber can only be observed actively. That is, the subscriber could vary its list and observe how the client responds, in order to probe for the client’s trust anchor list.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">This is similar to the baseline exposure for trust anchors that do not participate in negotiation. A subscriber in possession of a certificate can send it and determine if the relying party accepts or rejects it. Unlike this baseline exposure, trust anchors that participate in this protocol can be probed by only knowing the trust anchor identifier.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">Relying parties SHOULD determine which trust anchors participate in this mechanism, and whether to advertise them unconditionally or conditionally, based on their privacy goals. PKIs that reliably use the DNS service parameter (<a href="#dns-service-parameter" class="auto internal xref">Section 5</a>) can rely on conditional advertisement for stronger privacy properties without a round-trip penalty.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<p id="section-8.1-9">Additionally, a relying party that computes the <code>trust_anchors</code> extension based on prior state may allow observers to correlate across connections. Relying parties SHOULD NOT maintain such state across connections that are intended to be uncorrelated. As above, implementing the DNS service parameter can avoid a round-trip penalty without such state.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscribers">
<section id="section-8.2">
        <h3 id="name-subscribers">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-subscribers" class="section-name selfRef">Subscribers</a>
        </h3>
<p id="section-8.2-1">If the subscriber is a server, the mechanisms in <a href="#dns-service-parameter" class="auto internal xref">Section 5</a> and <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a> enumerate the trust anchors for the server’s available certification paths. This mechanism assumes they are not sensitive. Servers SHOULD NOT use this mechanism to negotiate certification paths with sensitive trust anchors.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">In servers that host multiple services, this protocol only enumerates certification paths for the requested service. If, for example, a server uses the <code>server_name</code> extension to select services, the addition to EncryptedExtensions in <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a> is expected to be filtered by <code>server_name</code>. Likewise, the DNS parameter in <a href="#dns-service-parameter" class="auto internal xref">Section 5</a> only contains information for the corresponding service. In both cases, co-located services are not revealed.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The above does not apply if the subscriber is a client. This protocol does not enumerate the available certification paths for a client.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="relying-party-policies-and-agility">
<section id="section-9.1">
        <h3 id="name-relying-party-policies-and-">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-relying-party-policies-and-" class="section-name selfRef">Relying Party Policies and Agility</a>
        </h3>
<p id="section-9.1-1">The negotiation mechanism described in this document facilitates which certification path is served to relying parties, but has no impact on the relying party's trust preferences themselves.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">As a result, this enables a more flexible and agile PKI, which can better mitigate security risks to users. <a href="#use-cases" class="auto internal xref">Section 7</a> discusses some scenarios which benefit from the multi-certificate deployment this document enables. In general, robust trust anchor negotiation helps subscribers navigate differences in relying party requirements. This means security improvements for one set of relying parties can be deployed without needing to risk incompatibility or breakage for others.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">For example, agility reduces pressures on relying parties to sacrifice user security for compatibility. Suppose a subscriber currently uses some CA, but a relying party deems trusting that CA to pose an unacceptable security risk to its users. In a single-certificate deployment, those subscribers may be unwilling to adopt a CA trusted by the relying party, as switching CAs risks compatibility problems elsewhere. The relying party then faces compatibility pressure and adds this CA, sacrificing user security. However, in a multi-certificate deployment, the subscriber can use its existing CA <em>in addition to</em> another CA trusted by relying party B. This allows the ecosystem to improve interoperability, while still meeting relying party B's user-security goals.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="incorrect-selection-metadata">
<section id="section-9.2">
        <h3 id="name-incorrect-selection-metadat">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-incorrect-selection-metadat" class="section-name selfRef">Incorrect Selection Metadata</a>
        </h3>
<p id="section-9.2-1">If the subscriber has incorrect information about trust anchor identifiers, it may send an untrusted certification path. This will not result in that path being trusted, but does present the possibility of a degradation of service. However, this information is provisioned by the CA, which is already expected to provide accurate information.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serving-multiple-certificates">
<section id="section-9.3">
        <h3 id="name-serving-multiple-certificat">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-serving-multiple-certificat" class="section-name selfRef">Serving Multiple Certificates</a>
        </h3>
<p id="section-9.3-1">In a multi-certificate deployment, subscribers have a collection of certificates available to satisfy relying parties with potentially different security policies. It is possible that some of these policies will only be satisfied by certificates from CAs that have been distrusted by other relying parties, such as if the relying party is out of date but still important for the subscriber to support. If a certificate asserts the correct information about the subscriber (TLS key, DNS names, etc.), the subscriber can safely present it, even if the CA is otherwise untrustworthy. Issuing a certificate for the subscriber's public key does not grant the CA access to the corresponding private key. Presenting such a certificate does not enable the CA decrypt or intercept the connection.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">However, the subscriber presenting a certificate is not an endorsement of the CA. The subscriber's role is to present a certificate which will convince the relying party of the correct subscriber information. Subscribers do not vet CAs for trustworthiness, only the correctness of their specific, configured certificates and the CA's ability to meet the subscriber's requirements, such as availability, compatibility, and performance. It is the responsibility of the relying party, and its corresponding root program, to determine the set of trusted CAs. Trusting a CA means trusting <em>all</em> certificates issued by that CA, so it is not enough to observe subscribers serving correct certificates. An untrustworthy CA may sign one correct certificate, but also sign incorrect certificates, possibly in the future, that can attack the relying party. Root program management is a complex, security-critical process, the full considerations of which are outside the scope of this document.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="targeting-tls-interception">
<section id="section-9.4">
        <h3 id="name-targeting-tls-interception">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-targeting-tls-interception" class="section-name selfRef">Targeting TLS Interception</a>
        </h3>
<p id="section-9.4-1">Trust Anchor Identifiers, like <code>certificate_authorities</code>, enables a TLS server to differentiate between clients that do and do not trust some CA. If this CA mis-issued a certificate, this could be used by a network attacker to only enable TLS interception with clients that trust the CA. The network attacker may wish to do this reduce the odds of detection. Clients which do not trust the CA will not accept the mis-issued certificate, which may be user-visible.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">However, the attacker could also use any existing mechanism for differentiating clients. In TLS parameter negotiation, the client offers all its available TLS features, including cipher suites and other extensions, in the TLS ClientHello. This means any variation in any client TLS policies, related or unrelated to trust anchors, may be used as an implementation fingerprint to differentiate clients. While fingerprinting's heuristic nature makes it not viable for a broad, diverse set of TLS servers, it is viable for a network attacker's single interception service. Trust Anchor Identifiers only impacts detection where this differentiation was not already possible.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">If the attacker targets any clients that enforce Certificate Transparency <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span>, the mis-issued certificates will need to be publicly logged. In this case, detection is more robust, and client differentiation, with or without Trust Anchor Identifiers, has no significant impact.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-extensiontype-updates">
<section id="section-10.1">
        <h3 id="name-tls-extensiontype-updates">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-tls-extensiontype-updates" class="section-name selfRef">TLS ExtensionType Updates</a>
        </h3>
<p id="section-10.1-1">IANA is requested to create the following entry in the TLS ExtensionType Values registry, defined by <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">trust_anchors</td>
              <td class="text-left" rowspan="1" colspan="1">CH, EE, CR, CT</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">[this-RFC]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="certificatepropertytype-registry">
<section id="section-10.2">
        <h3 id="name-certificatepropertytype-reg">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-certificatepropertytype-reg" class="section-name selfRef">CertificatePropertyType Registry</a>
        </h3>
<p id="section-10.2-1">[[TODO: Establish / add to the CertificatePropertyType registry]]<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.davidben-tls-trust-expr">[I-D.davidben-tls-trust-expr]</dt>
        <dd>
<span class="refAuthor">Benjamin, D.</span>, <span class="refAuthor">O'Brien, D.</span>, and <span class="refAuthor">B. Beck</span>, <span class="refTitle">"TLS Trust Expressions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-davidben-tls-trust-expr-04</span>, <time datetime="2024-06-28" class="refDate">28 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-davidben-tls-trust-expr-04">https://datatracker.ietf.org/doc/html/draft-davidben-tls-trust-expr-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4158">[RFC4158]</dt>
        <dd>
<span class="refAuthor">Cooper, M.</span>, <span class="refAuthor">Dzambasow, Y.</span>, <span class="refAuthor">Hesse, P.</span>, <span class="refAuthor">Joseph, S.</span>, and <span class="refAuthor">R. Nicholas</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure: Certification Path Building"</span>, <span class="seriesInfo">RFC 4158</span>, <span class="seriesInfo">DOI 10.17487/RFC4158</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4158">https://www.rfc-editor.org/rfc/rfc4158</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6973">https://www.rfc-editor.org/rfc/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9371">[RFC9371]</dt>
        <dd>
<span class="refAuthor">Baber, A.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Registration Procedures for Private Enterprise Numbers (PENs)"</span>, <span class="seriesInfo">RFC 9371</span>, <span class="seriesInfo">DOI 10.17487/RFC9371</span>, <time datetime="2023-03" class="refDate">March 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9371">https://www.rfc-editor.org/rfc/rfc9371</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X680">[X680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time datetime="2021" class="refDate">2021</time>. </dd>
<dd class="break"></dd>
<dt id="X690">[X690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time datetime="2021" class="refDate">2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-wkech">[I-D.ietf-tls-wkech]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Salz, R.</span>, and <span class="refAuthor">B. M. Schwartz</span>, <span class="refTitle">"A well-known URI for publishing ECHConfigList values."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-wkech-05</span>, <time datetime="2024-07-07" class="refDate">7 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-wkech-05">https://datatracker.ietf.org/doc/html/draft-ietf-tls-wkech-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MOZILLA-ROOTS">[MOZILLA-ROOTS]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refTitle">"Mozilla Included CA Certificate List"</span>, <time datetime="2023-08-30" class="refDate">30 August 2023</time>, <span>&lt;<a href="https://wiki.mozilla.org/CA/Included_Certificates">https://wiki.mozilla.org/CA/Included_Certificates</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6962">[RFC6962]</dt>
      <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Kasper</span>, <span class="refTitle">"Certificate Transparency"</span>, <span class="seriesInfo">RFC 6962</span>, <span class="seriesInfo">DOI 10.17487/RFC6962</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6962">https://www.rfc-editor.org/rfc/rfc6962</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="comparison-to-tls-trust-expressions">
<section id="appendix-A">
      <h2 id="name-comparison-to-tls-trust-exp">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-comparison-to-tls-trust-exp" class="section-name selfRef">Comparison to TLS Trust Expressions</a>
      </h2>
<p id="appendix-A-1"><span>[<a href="#I-D.davidben-tls-trust-expr" class="cite xref">I-D.davidben-tls-trust-expr</a>]</span> describes Trust Expressions, another trust anchor negotiation mechanism that aims to solve similar problems. The mechanisms differ in the following ways:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1"><code>trust_anchors</code> is usable by more kinds of PKIs. Trust Expressions express trust anchor lists relative to named “trust stores”, maintained by root programs. Arbitrary lists may not be easily expressible. <code>trust_anchors</code> does not have this restriction.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">When used with large trust stores, the retry mechanism in <code>trust_anchors</code> requires a new connection. In most applications, this must be implemented outside the TLS stack, so more components must be changed and redeployed. In deployments that are limited by client changes, this may be a more difficult transition. [[TODO: See <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a> for an alternate retry scheme that avoids this.]]<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">Trust Expressions works with static server configuration. An ideal <code>trust_anchors</code> deployment requires automation to synchronize a server’s DNS and TLS configuration. <span>[<a href="#I-D.ietf-tls-wkech" class="cite xref">I-D.ietf-tls-wkech</a>]</span> could be a starting point for this automation. In deployments that are limited by server changes, this may be a more difficult transition.<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.4">
          <p id="appendix-A-2.4.1">Trust Expressions require that CAs continually fetch information from manifests that are published by root programs, while <code>trust_anchors</code> relies only on static pre-assigned trust anchor identifiers.<a href="#appendix-A-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.5">
          <p id="appendix-A-2.5.1"><code>trust_anchors</code>, when trust anchors are conditionally sent, has different fingerprinting properties. See <a href="#privacy-considerations" class="auto internal xref">Section 8</a>.<a href="#appendix-A-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.6">
          <p id="appendix-A-2.6.1"><code>trust_anchors</code> can only express large client trust stores (for server certificates), not large server trust stores. Large trust stores rely on the retry mechanism described in <a href="#retry-mechanism" class="auto internal xref">Section 4.3</a>, which is not available to client certificates.<a href="#appendix-A-2.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">The two mechanisms can be deployed together. A subscriber can have metadata for both mechanisms available, and a relying party can advertise both.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">[[TODO: remove this or move to supporting documentation if this becomes the canonical thing]]<a href="#appendix-A-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors thank Nick Harper, and Emily Stark for many valuable discussions and insights which led to this document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bob Beck</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bbe@google.com" class="email">bbe@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Benjamin</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davidben@google.com" class="email">davidben@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Devon O'Brien</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:asymmetric@google.com" class="email">asymmetric@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
