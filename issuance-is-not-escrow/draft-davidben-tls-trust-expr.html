<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>TLS Trust Expressions</title>
<meta content="David Benjamin" name="author">
<meta content="Devon O'Brien" name="author">
<meta content="Bob Beck" name="author">
<meta content="
       This document defines TLS trust expressions, a mechanism for relying parties to succinctly convey trusted certification authorities to subscribers by referencing named and versioned trust stores. It also defines supporting mechanisms for subscribers to evaluate these trust expressions, and select one of several available certification paths to present. This enables a multi-certificate deployment model, for a more agile and flexible PKI that can better meet security requirements. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="draft-davidben-tls-trust-expr-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-davidben-tls-trust-expr.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TLS Trust Expressions</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Benjamin, et al.</td>
<td class="center">Expires 19 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-davidben-tls-trust-expr-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-18" class="published">18 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-19">19 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Benjamin</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">D. O'Brien</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">B. Beck</div>
<div class="org">Google LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">TLS Trust Expressions</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines TLS trust expressions, a mechanism for relying parties to succinctly convey trusted certification authorities to subscribers by referencing named and versioned trust stores. It also defines supporting mechanisms for subscribers to evaluate these trust expressions, and select one of several available certification paths to present. This enables a multi-certificate deployment model, for a more agile and flexible PKI that can better meet security requirements.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://davidben.github.io/tls-trust-expressions/draft-davidben-tls-trust-expr.html">https://davidben.github.io/tls-trust-expressions/draft-davidben-tls-trust-expr.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-davidben-tls-trust-expr/">https://datatracker.ietf.org/doc/draft-davidben-tls-trust-expr/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Layer Security Working Group mailing list (<span><a href="mailto:tls@ietf.org">mailto:tls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tls/">https://www.ietf.org/mailman/listinfo/tls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/davidben/tls-trust-expressions">https://github.com/davidben/tls-trust-expressions</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-time" class="internal xref">Time</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-terminology-and-roles" class="internal xref">Terminology and Roles</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-trust-store-manifests" class="internal xref">Trust Store Manifests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-trust-store-identifiers" class="internal xref">Trust Store Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-trust-store-entry-expiratio" class="internal xref">Trust Store Entry Expiration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-labels" class="internal xref">Labels</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-certificate-properties" class="internal xref">Certificate Properties</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-trust-store-inclusion" class="internal xref">Trust Store Inclusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-computing-trust-store-inclu" class="internal xref">Computing Trust Store Inclusions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-media-type" class="internal xref">Media Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-tls-certificate-negotiation" class="internal xref">TLS Certificate Negotiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-trust-expressions" class="internal xref">Trust Expressions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-subscriber-acknowledgement" class="internal xref">Subscriber Acknowledgement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-evaluating-trust-expression" class="internal xref">Evaluating Trust Expressions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-subscriber-behavior" class="internal xref">Subscriber Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-constructing-trust-expressi" class="internal xref">Constructing Trust Expressions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-issuing-certificates" class="internal xref">Issuing Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-acme-extension" class="internal xref">ACME Extension</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-key-rotation" class="internal xref">Key Rotation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-adding-cas" class="internal xref">Adding CAs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-removing-cas" class="internal xref">Removing CAs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-other-root-transitions" class="internal xref">Other Root Transitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-intermediate-elision" class="internal xref">Intermediate Elision</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-conflicting-relying-party-r" class="internal xref">Conflicting Relying Party Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-backup-certificates" class="internal xref">Backup Certificates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-relying-party-policies-and-" class="internal xref">Relying Party Policies and Agility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-incorrect-selection-metadat" class="internal xref">Incorrect Selection Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-serving-multiple-certificat" class="internal xref">Serving Multiple Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-targeting-tls-interception" class="internal xref">Targeting TLS Interception</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-tls-extensiontype-updates" class="internal xref">TLS ExtensionType Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-media-type-updates" class="internal xref">Media Type Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-certificatepropertytype-reg" class="internal xref">CertificatePropertyType Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-cddl-schema" class="internal xref">CDDL Schema</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> endpoints typically authenticate using X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. These are used as assertions by a certification authority (CA) that associate some TLS key with some DNS name or other identifier. If the peer trusts the CA, it will accept this association. The authenticating party is known as the subscriber and the peer is the relying party.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Subscribers typically provision a single certificate for all supported relying parties, because relying parties do not communicate which CAs are trusted. This certificate must then simultaneously meet requirements for all relying parties.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This constraint imposes costs on the ecosystem as PKIs evolve over time. The older the relying party, the more its requirements may have diverged from newer ones, making it increasingly difficult for subscribers to support both. This translates to analogous costs for CAs and relying parties:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">For a new CA to be usable by subscribers, it must be trusted by all relying parties. This is particularly challenging for older, unupdatable relying parties. Existing CAs face similar challenges when rotating or deploying new keys.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">When a relying party must update its policies to meet new security requirements, it must choose between compromising on user security or imposing a significant burden on subscribers that still support older relying parties.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">This document aims to remove this constraint with a multi-certificate deployment model. Subscribers are instead provisioned with multiple certificates and automatically select the correct one to use with each relying party. This allows a single subscriber to use different certificates for different relying parties, including older and newer ones.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This model requires the endpoints to somehow negotiate which certificate to use. <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.4" class="relref">Section 4.2.4</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> defines the <code>certificate_authorities</code> extension, but it is often impractical. Some trust stores are large, and the X.509 Name structure is inefficient. For example, as of August 2023, the Mozilla CA Certificate Program <span>[<a href="#MOZILLA-ROOTS" class="cite xref">MOZILLA-ROOTS</a>]</span> would encode 144 names totaling 14,457 bytes. Instead, this document defines a TLS extension and supporting mechanisms that allow relying parties and subscribers to succinctly communicate supported trust anchors to subscribers, using pre-shared information provisioned by root programs and CAs, respectively.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Together, these mechanisms enable subscribers to deploy multiple certificates, which supports a more flexible, robust Public Key Infrastructure (PKI). <a href="#use-cases" class="auto internal xref">Section 9</a> discusses several deployment use cases that benefit from this model.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document additionally uses the TLS presentation language defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="time">
<section id="section-2.1">
        <h3 id="name-time">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-time" class="section-name selfRef">Time</a>
        </h3>
<p id="section-2.1-1">Times in this document are represented by POSIX timestamps, which are integers containing a number of seconds since the Epoch, defined in Section 4.16 of <span>[<a href="#POSIX" class="cite xref">POSIX</a>]</span>. That is, the number of seconds after 1970-01-01 00:00:00 UTC, excluding leap seconds. A UTC time is converted to a POSIX timestamp as described in <span>[<a href="#POSIX" class="cite xref">POSIX</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Durations of time are integers, representing a number of seconds not including leap seconds. They can be added to POSIX timestamps to produce other POSIX timestamps.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">The current time is a POSIX timestamp determined by converting the current UTC time to seconds since the Epoch as per Section 4.16 of <span>[<a href="#POSIX" class="cite xref">POSIX</a>]</span>. One POSIX timestamp is said to be before (respectively, after) another POSIX timestamp if it is less than (respectively, greater than) the other value.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology-and-roles">
<section id="section-2.2">
        <h3 id="name-terminology-and-roles">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-terminology-and-roles" class="section-name selfRef">Terminology and Roles</a>
        </h3>
<p id="section-2.2-1">This document discusses four roles:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">Subscriber:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1">The party whose identity is being validated in the protocol. In TLS, this is the side sending the Certificate and CertificateVerify message.<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">Relying party:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">
            <p id="section-2.2-2.4.1">The party that authenticates the subscriber. In TLS, this is the side that validates a Certificate and CertificateVerify message.<a href="#section-2.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">Certification authority (CA):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6">
            <p id="section-2.2-2.6.1">The service that issues certificates to the subscriber.<a href="#section-2.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">Root program:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8">
            <p id="section-2.2-2.8.1">An entity that manages a set of common trusted CAs for a set of relying parties.<a href="#section-2.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-3">While the first three roles are common to most X.509 deployments, this document discusses the role of a root program as distinct from the relying party. Trust decisions are often common between related relying parties, such as multiple clients running the same application. The root program is the entity making those common decisions, such as the software vendor for the application or operating system.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Additionally, there are several terms used throughout this document to describe this proposal:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-5">
          <dt id="section-2.2-5.1">Trust anchor:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.2">
            <p id="section-2.2-5.2.1">A pre-distributed public key or certificate that relying parties use to determine whether a certification path is trusted.<a href="#section-2.2-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.3">Trust store:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.4">
            <p id="section-2.2-5.4.1">A collection of trust anchors managed by the root program.<a href="#section-2.2-5.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.5">Certification path:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.6">
            <p id="section-2.2-5.6.1">An ordered list of X.509 certificates starting the target certificate. Each certificate is issued by the next certificate, except the last, which is issued by a trust anchor.<a href="#section-2.2-5.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.7">Trust store manifest:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.8">
            <p id="section-2.2-5.8.1">A structure describing a series of versioned trust stores.<a href="#section-2.2-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.9">Trust expression:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.10">
            <p id="section-2.2-5.10.1">A compact description of a relying party's trust store contents, referencing named, versioned trust stores.<a href="#section-2.2-5.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.11">CertificatePropertyList:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.12">
            <p id="section-2.2-5.12.1">A structure associated with a certification path, containing additional information from the CA, for use by the subscriber when presenting the certification path.<a href="#section-2.2-5.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.13">TrustStoreInclusionList:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.14">
            <p id="section-2.2-5.14.1">A property in the CertificatePropertyList which describes the corresponding trust anchor's inclusion in trust stores. This is used by the subscriber when evaluating trust expressions.<a href="#section-2.2-5.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">In the TLS handshake, a relying party sends trust expressions, which reference named, versioned trust stores to describe a list of trust anchors. The subscriber uses this information to select a certification path to return.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">These structures are intended to be provisioned by root programs and CAs as follows:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1">Root programs maintain versions of a trust store over time in a trust store manifest, which is published to a well-known location. (See <a href="#trust-store-manifests" class="auto internal xref">Section 4</a>.)<a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1">CAs regularly fetch trust store manifests. CAs use these manifests to associate TrustStoreInclusionList structures with issued certification paths. This communicates the trust anchor's inclusion status to subscribers. (See <a href="#trust-store-inclusion" class="auto internal xref">Section 5.1</a>.)<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.3">
          <p id="section-3-3.3.1">The CA issues multiple certification paths to subscribers, which together cover all supported relying parties. The provisioning process is expected to be automated. (See <a href="#issuing-certificates" class="auto internal xref">Section 7</a>).<a href="#section-3-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.4">
          <p id="section-3-3.4.1">When updating a relying party's list of supported trust anchors, root programs also send a compact description as a TrustExpressionList. (See <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a>.)<a href="#section-3-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.5">
          <p id="section-3-3.5.1">During a TLS handshake, relying parties send their TrustExpressionList to subscribers. (See <a href="#trust-expressions" class="auto internal xref">Section 6.1</a>.)<a href="#section-3-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.6">
          <p id="section-3-3.6.1">Subscribers select certification paths by evaluating the TrustExpressionList with each path's TrustStoreInclusionList. Subscribers are then assured that all supported relying parties will be satisfied by some available path. (See <a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a>.)<a href="#section-3-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-4">By providing accurate trust anchor negotiation, this process avoids the need for relying parties to perform path-building <span>[<a href="#RFC4158" class="cite xref">RFC4158</a>]</span>. Certification paths can be pre-constructed to end at one of the relying party's supported anchors.<a href="#section-3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-store-manifests">
<section id="section-4">
      <h2 id="name-trust-store-manifests">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-trust-store-manifests" class="section-name selfRef">Trust Store Manifests</a>
      </h2>
<p id="section-4-1">This section defines a trust store manifest, which is a structure published by the root program to some well-known location. These manifests are used to compute certificate properties for the subscriber (<a href="#certificate-properties" class="auto internal xref">Section 5</a>) and trust expressions for the relying party (<a href="#tls-certificate-negotiation" class="auto internal xref">Section 6</a>).<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Trust store manifests are identified by a short, unique trust store identifier and define a list of trust store versions. A trust store version contains a set of trust anchors, and is identified by an identifier (from the manifest) and a version number.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">A trust store manifest is a JSON object <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> containing:<a href="#section-4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4">
        <dt id="section-4-4.1">
<code>id</code>:</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.2">
          <p id="section-4-4.2.1">A string containing a a trust store identifier in text form, as described in <a href="#trust-store-ids" class="auto internal xref">Section 4.1</a>.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.3">
<code>max_age</code>:</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.4">
          <p id="section-4-4.4.1">A non-negative integer containing the number of seconds that this document may be cached.<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.5">
<code>trust_anchors</code>:</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.6">
          <p id="section-4-4.6.1">A non-empty object describing a set of trust anchors. Each member's name is a short identifier for the trust anchor, used in <code>entries</code> below. Each member's value is an object describing the trust anchor, containing:<a href="#section-4-4.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4.6.2">
            <dt id="section-4-4.6.2.1">
<code>type</code>:</dt>
            <dd style="margin-left: 1.5em" id="section-4-4.6.2.2">
              <p id="section-4-4.6.2.2.1">A string describing the type of trust anchor.<a href="#section-4-4.6.2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4-4.6.3">In this document, the value of <code>type</code> is always "x509". In this case, the object additionally contains a member <code>data</code> whose value is a string containing a base64-encoded <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>, DER-encoded <span>[<a href="#X690" class="cite xref">X690</a>]</span> X.509 certificate.<a href="#section-4-4.6.3" class="pilcrow">¶</a></p>
<p id="section-4-4.6.4">Future documents may extend this format with other trust anchor types. Recipients MUST ignore trust anchors with unrecognized <code>type</code>.<a href="#section-4-4.6.4" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.7">
<code>versions</code>:</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.8">
          <p id="section-4-4.8.1">A non-empty array describing versions of the trust store. Each element of the array is a JSON object containing:<a href="#section-4-4.8.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4.8.2">
            <dt id="section-4-4.8.2.1">
<code>timestamp</code>:</dt>
            <dd style="margin-left: 1.5em" id="section-4-4.8.2.2">
              <p id="section-4-4.8.2.2.1">An integer, which is the time at which this trust store version was defined, as a POSIX timestamp (see <a href="#time" class="auto internal xref">Section 2.1</a>).<a href="#section-4-4.8.2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4-4.8.2.3">
<code>entries</code>:</dt>
            <dd style="margin-left: 1.5em" id="section-4-4.8.2.4">
              <p id="section-4-4.8.2.4.1">A non-empty array describing the contents of this version of the trust store. These are known as trust store entries. Each element is an object containing:<a href="#section-4-4.8.2.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4.8.2.4.2">
                <dt id="section-4-4.8.2.4.2.1">
<code>trust_anchor</code>:</dt>
                <dd style="margin-left: 1.5em" id="section-4-4.8.2.4.2.2">
                  <p id="section-4-4.8.2.4.2.2.1">A string containing the name of some member of the <code>trust_anchors</code> object.<a href="#section-4-4.8.2.4.2.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-4-4.8.2.4.2.3">
<code>labels</code>:</dt>
                <dd style="margin-left: 1.5em" id="section-4-4.8.2.4.2.4">
                  <p id="section-4-4.8.2.4.2.4.1">A non-empty array of non-negative, 24-bit integer labels associated with the trust anchor. See <a href="#labels" class="auto internal xref">Section 4.3</a> for how this field is interpreted.<a href="#section-4-4.8.2.4.2.4.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-4-4.8.2.4.2.5">
<code>max_lifetime</code>:</dt>
                <dd style="margin-left: 1.5em" id="section-4-4.8.2.4.2.6">
                  <p id="section-4-4.8.2.4.2.6.1">A non-negative integer containing the maximum lifetime, in seconds, of certification paths that this trust anchor is expected to issue.<a href="#section-4-4.8.2.4.2.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-5">Versions in <code>versions</code> are identified by their zero-indexed position in the array. That is, the first entry is version 0, the second is version 1, and so on.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Recipients MUST ignore JSON object members with unrecognized names in each of the objects defined above. Future documents MAY extend these formats with new names. <a href="#cddl-schema" class="auto internal xref">Appendix A</a> contains a CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> describing the above structure.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">When updating a trust store manifest, root programs append a new object to the <code>versions</code> array to represent the new trust store version. When the new object references a trust anchor, the root program uses the existing members of <code>trust_anchors</code>, or adds new members as required. Updates MUST NOT modify or remove existing entries in the <code>versions</code> array.<a href="#section-4-7" class="pilcrow">¶</a></p>
<div id="trust-store-ids">
<section id="section-4.1">
        <h3 id="name-trust-store-identifiers">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-trust-store-identifiers" class="section-name selfRef">Trust Store Identifiers</a>
        </h3>
<p id="section-4.1-1">To simplify allocation, trust store identifiers use object identifiers (OIDs) <span>[<a href="#X680" class="cite xref">X680</a>]</span> based on Private Enterprise Numbers (PENs) <span>[<a href="#RFC9371" class="cite xref">RFC9371</a>]</span>. An organization may define a trust store by allocating some OID under its PEN. For example, an organization with PEN 32473 might allocate a trust store identified by the OID <code>1.3.6.1.4.1.32473.1</code>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">For compactness, this document uses relative object identifiers (see Section 33 of <span>[<a href="#X680" class="cite xref">X680</a>]</span>), relative to the OID prefix <code>1.3.6.1.4.1</code>. In the text form, these are written in dotted decimal notation, such as <code>32473.1</code>. In a binary protocol, such as TLS, this is encoded as the contents octets of the relative object identifier's DER encoding, as described in Section 8.20 of <span>[<a href="#X690" class="cite xref">X690</a>]</span>. Note this omits the tag and length portion of the encoding. For example, the binary encoding of <code>32473.1</code> would be the four-octet sequence <code>{0x81, 0xfd, 0x59, 0x01}</code>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiration">
<section id="section-4.2">
        <h3 id="name-trust-store-entry-expiratio">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-trust-store-entry-expiratio" class="section-name selfRef">Trust Store Entry Expiration</a>
        </h3>
<p id="section-4.2-1">The <code>max_age</code> and <code>max_lifetime</code> fields define an expiration time for trust store entries in versions other than the latest version. For a trust store entry in version V, the expiration time is the sum of:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">The <code>timestamp</code> of the subsequent version, i.e. version V+1<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">The <code>max_age</code> of the manifest<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1">The <code>max_lifetime</code> of the trust store entry<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-3">Expiration times for entries in the latest version are not defined. They are determined once the root store appends a new version.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Trust store entries are not removed from their containing version after they expire. Rather, the expiration time is the point at which all unexpired certificates have incorporated information about subsequent trust store versions, per <a href="#computing-trust-store-inclusions" class="auto internal xref">Section 5.2</a>. This ensures the negotiation procedures in <a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a> and <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a> interoperate.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="labels">
<section id="section-4.3">
        <h3 id="name-labels">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-labels" class="section-name selfRef">Labels</a>
        </h3>
<p id="section-4.3-1">Trust store entries reference labels, which are 24-bit integers that identify subsets of a trust store version. These integers are defined relative to the trust store manifest and are not globally unique. Root programs allocate labels when defining versions of a trust store.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Labels are used in trust expressions (<a href="#trust-expressions" class="auto internal xref">Section 6.1</a>) to exclude trust anchor entries from the expression. A label may identify an individual trust anchor if it is the only one with that label, or multiple trust anchors if they share the label.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">The root program's label allocation scheme determines which sets may be efficiently represented. In particular, when trust anchors are removed in a later version of a trust store, trust expressions must express the removed set with labels as described in <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a>. Root programs SHOULD allocate individual labels for each trust anchor, and shared labels for trust anchors that will likely be removed together. For example, the root program may allocate shared labels for trust anchors with the same operator, or trust anchors that use some signature algorithm if it expects some relying parties to exclude by algorithm.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">When allocating labels, root programs MAY repurpose a previously allocated label value after all previous entries referencing it have expired (<a href="#expiration" class="auto internal xref">Section 4.2</a>).<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certificate-properties">
<section id="section-5">
      <h2 id="name-certificate-properties">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-certificate-properties" class="section-name selfRef">Certificate Properties</a>
      </h2>
<p id="section-5-1">In order to evaluate references to trust stores, e.g. in <a href="#trust-expressions" class="auto internal xref">Section 6.1</a>, subscribers require information about which trust stores contain each candidate certification path's trust anchor. This document introduces an extensible CertificatePropertyList structure to carry this information.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">CertificatePropertyLists are constructed by CAs and sent to subscribers, alongside the certification path itself. They contain a list of properties the subscriber may use when presenting the certificate, e.g. as an input to certificate negotiation (<a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a>).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">A CertificatePropertyList is defined using the TLS presentation language (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>) below:<a href="#section-5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-4">
<pre>
enum { trust_stores(0), (2^16-1) } CertificatePropertyType;

struct {
    CertificatePropertyType type;
    opaque data&lt;0..2^16-1&gt;;
} CertificateProperty;

CertificateProperty CertificatePropertyList&lt;0..2^16-1&gt;;
</pre><a href="#section-5-4" class="pilcrow">¶</a>
</div>
<p id="section-5-5">The entries in a CertificatePropertyList MUST be sorted numerically by <code>type</code> and MUST NOT contain values with a duplicate <code>type</code>. Inputs that do not satisfy these invariants are syntax errors and MUST be rejected by parsers.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">This document defines a single property, <code>trust_stores</code>, which describes trust store inclusion. Future documents may define other properties for use with other mechanisms.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">Subscribers MUST ignore unrecognized properties with CertificatePropertyType values. If ignoring a property would cause such subscribers to misinterpret the structure, the document defining the CertificatePropertyType SHOULD include a mechanism for CAs to negotiate the new property with the subscriber in certificate management protocols such as ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.<a href="#section-5-7" class="pilcrow">¶</a></p>
<div id="trust-store-inclusion">
<section id="section-5.1">
        <h3 id="name-trust-store-inclusion">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-trust-store-inclusion" class="section-name selfRef">Trust Store Inclusion</a>
        </h3>
<p id="section-5.1-1">The <code>trust_stores</code> property specifies which trust stores contain the certification path's trust anchor. Its <code>data</code> field contains a TrustStoreInclusionList, defined below:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
enum {
    previous_version(0),
    latest_version_at_issuance(1)
} TrustStoreStatus;

struct {
    opaque id&lt;1..2^8-1&gt;;
    uint24 version;
} TrustStore;

struct {
    TrustStore trust_store;
    TrustStoreStatus status;
    uint24 labels&lt;1..2^16-1&gt;;
} TrustStoreInclusion;

TrustStoreInclusion TrustStoreInclusionList&lt;1..2^16-1&gt;;
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">Each TrustStoreInclusion describes a trust store version which contains this certification path's trust anchor. <code>trust_store</code> specifies a version of the trust store, and <code>labels</code> specifies the trust anchor's labels within that trust store.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">If <code>status</code> is <code>latest_version_at_issuance</code>, <code>trust_store</code> was the latest version at the time the certificate was issued. In this case, the trust expression evaluation algorithm (<a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a>) predicts this information additionally applies to all versions greater than <code>trust_store</code>'s <code>version</code>, up to the expiration of the certification path.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">A TrustStoreInclusionList MUST satisfy the following invariants:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-6.1">
            <p id="section-5.1-6.1.1">Each TrustStoreInclusion has a unique <code>trust_store</code> value.<a href="#section-5.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-6.2">
            <p id="section-5.1-6.2.1">The TrustStoreInclusion structures are sorted, first by length of <code>trust_store</code>'s <code>id</code>, then by <code>trust_store</code>'s <code>id</code> lexicographically, then by <code>trust_store</code>'s <code>version</code>.<a href="#section-5.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-6.3">
            <p id="section-5.1-6.3.1">If <code>status</code> is <code>latest_version_at_issuance</code> in some TrustStoreInclusion, no <code>trust_store</code> with the same <code>id</code> but higher <code>version</code> appears in the list.<a href="#section-5.1-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="computing-trust-store-inclusions">
<section id="section-5.2">
        <h3 id="name-computing-trust-store-inclu">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-computing-trust-store-inclu" class="section-name selfRef">Computing Trust Store Inclusions</a>
        </h3>
<p id="section-5.2-1">Each CA regularly fetches trust store manifests from root programs in which it participates, caching the most recently fetched manifest from each root program. When issuing a certification path to a subscriber, it runs the following procedure on each root program's trust store manifest, to compute a list of TrustStoreInclusions:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2">
<li id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">If the cached manifest was fetched more than <code>max_age</code> seconds ago, fetch and cache a new copy.<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">For each trust store version in the cached manifest's <code>versions</code>:<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-5.2-2.2.2">
<li id="section-5.2-2.2.2.1">
                <p id="section-5.2-2.2.2.1.1">Look for a trust store entry whose <code>trust_anchor</code> field, when indexed into <code>trust_anchors</code>, matches the certification path's trust anchor.<a href="#section-5.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.2-2.2.2.2">
                <p id="section-5.2-2.2.2.2.1">If found, output a TrustStoreInclusion structure:<a href="#section-5.2-2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.2.2.2.2.1">
                    <p id="section-5.2-2.2.2.2.2.1.1">Set <code>trust_store</code> to the manifest's <code>id</code>, encoded in binary form as described in <a href="#trust-store-ids" class="auto internal xref">Section 4.1</a>, and the version's version number.<a href="#section-5.2-2.2.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.2-2.2.2.2.2.2">
                    <p id="section-5.2-2.2.2.2.2.2.1">Set <code>status</code> to <code>latest_version_at_issuance</code> if the trust store version is currently the latest version. Otherwise, set it to <code>previous_version</code>.<a href="#section-5.2-2.2.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.2-2.2.2.2.2.3">
                    <p id="section-5.2-2.2.2.2.2.3.1">Set <code>labels</code> to the trust store entry's <code>labels</code>.<a href="#section-5.2-2.2.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ol>
</li>
        </ol>
<p id="section-5.2-3">If the above procedure outputs a TrustStoreInclusion with <code>status</code> of <code>latest_version_at_issuance</code>, the certification path's lifetime MUST NOT exceed the corresponding trust store entry's <code>max_lifetime</code> field. This ensures the procedures in <a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a> and <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a> interoperate correctly.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The CA combines the outputs of this procedure for each known manifest to form the final TrustStoreInclusionList. To aid the CA in collecting manifests, repositories such as <span>[<a href="#CCADB" class="cite xref">CCADB</a>]</span> can publish a directory of trust store manifests from participating root programs.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="media-type">
<section id="section-5.3">
        <h3 id="name-media-type">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-media-type" class="section-name selfRef">Media Type</a>
        </h3>
<p id="section-5.3-1">A certification path with its associated CertificationPropertyList may be represented in a PEM <span>[<a href="#RFC7468" class="cite xref">RFC7468</a>]</span> structure in a file of type "application/pem-certificate-chain-with-properties". Files of this type MUST use the strict encoding and MUST NOT include explanatory text.  The ABNF <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span> for this format is
as follows, where "stricttextualmsg" and "eol" are as defined in
<span><a href="https://rfc-editor.org/rfc/rfc7468#section-3" class="relref">Section 3</a> of [<a href="#RFC7468" class="cite xref">RFC7468</a>]</span>:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
certchainwithproperties = stricttextualmsg eol stricttextualmsg
                          *(eol stricttextualmsg)
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">The first element MUST be the encoded CertificatePropertyList.
The second element MUST be an end-entity certificate.  Each following
certificate MUST directly certify the one preceding it. The certificate representing the trust anchor MUST be omitted from the path.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">CertificatePropertyLists are encoded using the "CERTIFICATE PROPERTIES" label. The encoded data is a serialized CertificatePropertyList, defined in <a href="#certificate-properties" class="auto internal xref">Section 5</a>.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">Certificates are encoded as in <span><a href="https://rfc-editor.org/rfc/rfc7468#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7468" class="cite xref">RFC7468</a>]</span>, except DER <span>[<a href="#X690" class="cite xref">X690</a>]</span> MUST be used.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">The following is an example file with a certification path containing an end-entity certificate and an intermediate certificate.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-7">
<pre>
-----BEGIN CERTIFICATE PROPERTIES-----
TODO fill in an example
-----END CERTIFICATE PROPERTIES-----
-----BEGIN CERTIFICATE-----
TODO fill in an example
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
TODO fill in an example
-----END CERTIFICATE-----
</pre><a href="#section-5.3-7" class="pilcrow">¶</a>
</div>
<p id="section-5.3-8">The IANA registration for this media type is described in <a href="#media-type-updates" class="auto internal xref">Section 12.2</a>.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tls-certificate-negotiation">
<section id="section-6">
      <h2 id="name-tls-certificate-negotiation">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-tls-certificate-negotiation" class="section-name selfRef">TLS Certificate Negotiation</a>
      </h2>
<p id="section-6-1">This section defines the <code>trust_expressions</code> extension, which is sent in the ClientHello, CertificateRequest, and Certificate messages in TLS 1.3 or later.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="trust-expressions">
<section id="section-6.1">
        <h3 id="name-trust-expressions">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-trust-expressions" class="section-name selfRef">Trust Expressions</a>
        </h3>
<p id="section-6.1-1">When the <code>trust_expressions</code> extension is sent in ClientHello and CertificateRequest, the <code>extension_data</code> field is a TrustExpressionList, defined below:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
enum { trust_expressions(TBD), (2^16-1) } ExtensionType;

struct {
    TrustStore trust_store;
    uint24 excluded_labels&lt;0..2^16-1&gt;;
} TrustExpression;

TrustExpression TrustExpressionList&lt;1..2^16-1&gt;;
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">A TrustExpressionList is an unordered set of TrustExpression objects. When a relying party sends a TrustExpressionList, it indicates support for all trust anchors specified by any TrustExpression contained in the list. A TrustExpression specifies a list of trust anchors in two parts:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">First, <code>trust_store</code> specifies a trust store by ID and version (see <a href="#trust-store-manifests" class="auto internal xref">Section 4</a>). Any trust anchors contained in the specified trust store are included.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Second, <code>excluded_labels</code> specifies a set of labels, each of which identify one or more trust anchors in a trust store manifest. Any trust anchors identified by any label in <code>excluded_labels</code> are excluded. <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a> discusses this set in more detail.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6"><code>excluded_labels</code> MUST be sorted in ascending order and contain no duplicate values to be valid. If invalid, receivers MUST terminate the connection with an <code>illegal_parameter</code> alert.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Together, a TrustExpression indicates that the relying party accepts all trust anchors in the referenced trust store version, except for any that were excluded via <code>excluded_labels</code>.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscriber-acknowledgement">
<section id="section-6.2">
        <h3 id="name-subscriber-acknowledgement">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-subscriber-acknowledgement" class="section-name selfRef">Subscriber Acknowledgement</a>
        </h3>
<p id="section-6.2-1">When the <code>trust_expressions</code> extension is sent in a Certificate message, the extension MUST be in the first CertificateEntry and the <code>extension_data</code> field MUST be empty. This extension indicates the subscriber selected a certification path using trust expressions.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">In this case, the <code>certificate_list</code> flexibility described in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> no longer applies. The <code>certificate_list</code> MUST contain a complete certification path, correctly ordered and with no extraneous certificates. That is, each certificate MUST certify the one immediately preceding it, and the trust anchor MUST certify the final certificate.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">If a relying party receives this extension in the Certificate message, it MAY choose to disable path building <span>[<a href="#RFC4158" class="cite xref">RFC4158</a>]</span> and validate the peer's certificate list as pre-built certification path. Doing so avoids the unpredictable behavior of path-building, and helps ensure CAs and subscribers do not inadvertently provision incorrect paths.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="evaluating-trust-expressions">
<section id="section-6.3">
        <h3 id="name-evaluating-trust-expression">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-evaluating-trust-expression" class="section-name selfRef">Evaluating Trust Expressions</a>
        </h3>
<p id="section-6.3-1">Given a certification path and a TrustExpressionList from the relying party, the subscriber runs the following procedure to determine if the relying party is claiming support for the path's trust anchor. If so, the TrustExpressionList is said to match the certification path:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-2">
<li id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">If the certification path does not have an associated <code>trust_store</code> certificate property (<a href="#trust-store-inclusion" class="auto internal xref">Section 5.1</a>), containing a TrustStoreInclusionList, terminate this procedure and return false. The certification path does not match the TrustExpressionList.<a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">If the certification path has expired, terminate this procedure and return false. Expired certification paths are expected to be rejected by the relying party and may also have stale TrustStoreInclusionLists.<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.3">
            <p id="section-6.3-2.3.1">Otherwise, for each TrustExpression in the relying party's TrustExpressionList:<a href="#section-6.3-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-2.3.2">
<li id="section-6.3-2.3.2.1">
                <p id="section-6.3-2.3.2.1.1">Find the TrustExpression's corresponding TrustStoreInclusion in the TrustStoreInclusionList, if any. The corresponding TrustStoreInclusion is the one where both of the following are true:<a href="#section-6.3-2.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.3.2.1.2.1">
                    <p id="section-6.3-2.3.2.1.2.1.1">The <code>id</code> fields of two structures' <code>trust_store</code> fields are equal.<a href="#section-6.3-2.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-2.3.2.1.2.2">
                    <p id="section-6.3-2.3.2.1.2.2.1">Either the <code>version</code> fields of the two structures' <code>trust_store</code> fields are equal, or the TrustStoreInclusion's <code>status</code> is <code>latest_version_at_issuance</code> and the <code>version</code> field of TrustExpression's <code>trust_store</code> is greater than that of the TrustStoreInclusion's <code>trust_store</code>.<a href="#section-6.3-2.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-6.3-2.3.2.1.3">
The invariants in <a href="#trust-store-inclusion" class="auto internal xref">Section 5.1</a> imply that at most one TrustStoreInclusion will satisfy this. Implementations may evaluate this efficiently by performing a binary search over the TrustStoreInclusionList.<a href="#section-6.3-2.3.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3-2.3.2.2">
                <p id="section-6.3-2.3.2.2.1">If there was no corresponding TrustStoreInclusion, continue to the next TrustExpression.<a href="#section-6.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3-2.3.2.3">
                <p id="section-6.3-2.3.2.3.1">Otherwise, check for common values between the TrustStoreInclusion's <code>labels</code> field and the TrustExpression's <code>excluded_labels</code> field. If there are no common values, terminate this procedure and return true. The certification path matches the TrustExpressionList. Otherwise, continue to the next TrustExpression.<a href="#section-6.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.3-2.4">
            <p id="section-6.3-2.4.1">If no match was found in the TrustExpressionList, return false. The certification path does not match the TrustExpressionList.<a href="#section-6.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.3-3">When a TrustStoreInclusion's <code>status</code> is <code>latest_version_at_issuance</code>, the above procedure predicts that trust anchors in the latest version will continue to be present in later versions. This allows relying parties using later trust store versions to continue to interoperate with certification paths that predate the later version. If this prediction is incorrect and the trust anchor has been removed from the later version, <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a> requires that the TrustExpression include appropriate <code>excluded_labels</code> values to mitigate this.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscriber-behavior">
<section id="section-6.4">
        <h3 id="name-subscriber-behavior">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-subscriber-behavior" class="section-name selfRef">Subscriber Behavior</a>
        </h3>
<p id="section-6.4-1">Subscribers using this negotiation scheme are configured with a list of candidate certification paths, with corresponding CertificatePropertyList (<a href="#certificate-properties" class="auto internal xref">Section 5</a>) structures. As a server (respectively, client) responding to a ClientHello (respectively, CertificateRequest), the subscriber selects the best candidate path, incorporating the matching algorithm described in <a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a>, and other criteria defined in TLS.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">If the subscriber selected a certification path which matched via trust expressions, it MUST include an empty <code>trust_expressions</code> extension in the first CertificateEntry.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">This document does not prescribe a precise selection procedure and configuration, but the following is an example implementation strategy:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">The TLS implementation allows the application to configure a list of candidate credentials, each with certification path, private key, and optional CertificatePropertyList, in preference order. This order may reflect a preference to, e.g., minimize message size, or more performant private keys. When selecting a credential, the TLS implementation iterates over each candidate in preference order and checks:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4-5">
<li id="section-6.4-5.1">
            <p id="section-6.4-5.1.1">Either the matching algorithm described in <a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a> returns true, or some other TLS extension, such as the <code>certificate_authorities</code> extension, indicates the relying party supports the trust anchor.<a href="#section-6.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.4-5.2">
            <p id="section-6.4-5.2.1">The certification path is suitable for use based on other TLS criteria. For example, the TLS <code>signature_algorithms</code> (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.3" class="relref">Section 4.2.3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>) extension constrains the types of keys which may be used.<a href="#section-6.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.4-5.3">
            <p id="section-6.4-5.3.1">The certification path satisfies any other application-specific constraints which may apply. For example, TLS servers often select certificates based on the <code>server_name</code> (<span><a href="https://rfc-editor.org/rfc/rfc6066#section-3" class="relref">Section 3</a> of [<a href="#RFC6066" class="cite xref">RFC6066</a>]</span>) extension.<a href="#section-6.4-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.4-6">The TLS implementation selects the first credential which satisfies all of its selection criteria. If no credentials match, the TLS implementation may return a <code>handshake_failure</code> alert, or consider a configured fallback set of credentials, which skip the first check above. These fallback credentials may be a separate credential list, or appended to the same list with an option to control the matching criteria.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">Fallback credentials allow the subscriber to retain support for relying parties that do not implement trust expressions. As they are be selected without trust anchor negotiation, the subscriber must find a sufficiently ubiquitous trust anchor, if one exists. However, unlike existing PKIs that do not use trust expressions, only relying parties without trust expressions need to be considered in this ubiquity determination. Updated relying parties may continue to evolve without restricting fallback credential selection.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="constructing-trust-expressions">
<section id="section-6.5">
        <h3 id="name-constructing-trust-expressi">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-constructing-trust-expressi" class="section-name selfRef">Constructing Trust Expressions</a>
        </h3>
<p id="section-6.5-1">Relying parties send the <code>trust_expressions</code> extension to advertise a set of accepted trust anchors. <a href="#privacy-considerations" class="auto internal xref">Section 10</a> discusses which trust anchors to advertise. Each trust expression to be sent advertises a subset of some trust store version. To communicate a set of trust anchors that span multiple trust stores, relying parties MAY send multiple trust expressions, each referencing a different trust store.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">For each referenced trust store version, the following procedure constructs a trust expression. This procedure is expected to be run by the root program, as part of defining new trust store versions and provisioning supported trust anchors in relying parties.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">[[TODO: This is written as a procedure, but we expect root programs to fill in the expected exclusions when they define a new trust store version, and then trim the compatibility exclusions as they expire. Also the root programs know their label allocation scheme and are the ones deciding on removals, so they're best situated to pick a set of <code>excluded_labels</code>. Perhaps this should get moved to the manifest?]]<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5-4">
<li id="section-6.5-4.1">
            <p id="section-6.5-4.1.1">Let <code>include_entries</code> and <code>exclude_entries</code> be two empty sets of trust anchor entries.<a href="#section-6.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.5-4.2">
            <p id="section-6.5-4.2.1">For each trust store entry in the trust store version:<a href="#section-6.5-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-6.5-4.2.2">
<li id="section-6.5-4.2.2.1">
                <p id="section-6.5-4.2.2.1.1">If the trust store entry's <code>trust_anchor</code> references a trust anchor that is in the desired subset, add it to <code>include_entries</code>.<a href="#section-6.5-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.5-4.2.2.2">
                <p id="section-6.5-4.2.2.2.1">Otherwise, add it to <code>exclude_entries</code>.<a href="#section-6.5-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.5-4.3">
            <p id="section-6.5-4.3.1">For all trust store entries in trust store versions before the specified version:<a href="#section-6.5-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-6.5-4.3.2">
<li id="section-6.5-4.3.2.1">
                <p id="section-6.5-4.3.2.1.1">If the current time is before the entry's expiration time (<a href="#expiration" class="auto internal xref">Section 4.2</a>) and if the entry's <code>trust_anchor</code> references a trust anchor that is not in the desired subset, add the entry to <code>exclude_entries</code>.<a href="#section-6.5-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.5-4.4">
            <p id="section-6.5-4.4.1">Compute a set of labels, <code>excluded_labels</code> such that:<a href="#section-6.5-4.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-6.5-4.4.2">
<li id="section-6.5-4.4.2.1">
                <p id="section-6.5-4.4.2.1.1">No label appears in any entry in <code>include_entries</code>.<a href="#section-6.5-4.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.5-4.4.2.2">
                <p id="section-6.5-4.4.2.2.1">For each entry in <code>exclude_entries</code>, there is some label in common between <code>excluded_labels</code> and the labels in the entry.<a href="#section-6.5-4.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-6.5-4.4.3">
How to compute this set depends on the root program's label allocation scheme (<a href="#labels" class="auto internal xref">Section 4.3</a>). If the root program allocates a label for each trust anchor, this set is always computable, though more efficient sets may be possible depending on the allocation scheme.<a href="#section-6.5-4.4.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.5-4.5">
            <p id="section-6.5-4.5.1">Output a TrustExpression such that <code>trust_store</code> is the referenced trust store version, and <code>excluded_labels</code> is the computed <code>excluded_labels</code> value.<a href="#section-6.5-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.5-5">This procedure uses <code>excluded_labels</code> for two kinds of exclusions:<a href="#section-6.5-5" class="pilcrow">¶</a></p>
<p id="section-6.5-6">First, if the trust store version includes undesired trust anchors, the trust expression should exclude them. This may occur if, for example, the trust store is used by all versions of the relying party's software, but some trust anchors are gated by software version.<a href="#section-6.5-6" class="pilcrow">¶</a></p>
<p id="section-6.5-7">Second, trust expressions exclude unexpired entries from previous versions. This is because the matching criteria described in <a href="#evaluating-trust-expressions" class="auto internal xref">Section 6.3</a> predictively applies TrustStoreInclusion values with <code>status</code> of <code>latest_version_at_issuance</code> to all future versions of a trust store. This allows relying parties to interoperate with subscribers with stale information. Unexpired entries are those for which such an unexpired certification path may still exist. Where this prediction is incorrect, trust expressions MUST mitigate this by excluding the past entries.<a href="#section-6.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="issuing-certificates">
<section id="section-7">
      <h2 id="name-issuing-certificates">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-issuing-certificates" class="section-name selfRef">Issuing Certificates</a>
      </h2>
<p id="section-7-1">Subscribers SHOULD use an automated issuance process where the CA transparently provisions multiple certification paths, without changes to subscriber configuration. As relying party requirements evolve, the CA adjusts its output to ensure its subscribers continue to interoperate with all supported relying parties. This results in a more flexible and agile PKI that can better respond to security incidents and changes in requirements. (See <a href="#use-cases" class="auto internal xref">Section 9</a> for details.)<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Subscribers MAY additionally combine the outputs from multiple CAs. This may be used, for example, to maintain backup certificates as described in <a href="#backup-certificates" class="auto internal xref">Section 9.7</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="acme-extension">
<section id="section-7.1">
        <h3 id="name-acme-extension">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-acme-extension" class="section-name selfRef">ACME Extension</a>
        </h3>
<p id="section-7.1-1">This section extends ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> to be able to issue certificate paths, each with an associated CertificatePropertyList by defining a new media type in <a href="#media-type" class="auto internal xref">Section 5.3</a>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">When an ACME server processes an order object, it MAY issue multiple certification paths, each with an associated TrustStoreInclusionList, computed as in <a href="#computing-trust-store-inclusions" class="auto internal xref">Section 5.2</a>. These paths MAY share an end-entity certificate but end at different trust anchors, or they MAY be completely distinct. The ACME server encodes each certification path using the application/pem-certificate-chain-with-properties format, defined in <a href="#media-type" class="auto internal xref">Section 5.3</a>).  Note this format is required to form a complete certification path. The CA MUST return a result that may be verified by relying parties without path building <span>[<a href="#RFC4158" class="cite xref">RFC4158</a>]</span>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The ACME server provides additional results to the client with the link relation header fields described in <span><a href="https://rfc-editor.org/rfc/rfc8555#section-7.4.2" class="relref">Section 7.4.2</a> of [<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>. When fetching certificates, the ACME client includes application/pem-certificate-chain-with-properties in its Accept header to indicate it supports the new format. Unlike the original mechanism described in <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>, these certification paths do not require heuristics to be used. Instead, the ACME client uses the associated TrustStoreInclusionLists to select a path as described in <a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">When the ACME client wishes to renew any of the certification paths issued in this order, it repeats this process to renew each path concurrently. Thus this extension is suitable when the CA is willing to issue and renew all paths together. It may not be appropriate if the paths have significantly different processing times or lifetimes. Future enhancements to ACME may be defined to address these cases, e.g. by allowing the ACME client to make independent orders.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example">
<section id="section-8">
      <h2 id="name-example">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-8-1">Suppose A1, A2, B1, B2, C1, and C2 are X.509 root certificates, such that A1 and A2 share an operator, B1 and B2 share an operator, and C1 and C2 share an operator.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">On January 1st, 2023, the root program includes A1, A2, B1, and B2. It allocates labels 0 through 3 for each individual CA and then 100 and 101 for the two CA operators. The CAs issue 90 day certificates and are permitted to use manifests stale by 10 days. The root store manifest may then be:<a href="#section-8-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-3">
<pre>
{
  "id": "32473.1",
  "max_age": 864000,
  "trust_anchors": {
    "A1": {"type": "x509", "data": "..."},
    "A2": {"type": "x509", "data": "..."},
    "B1": {"type": "x509", "data": "..."},
    "B2": {"type": "x509", "data": "..."}
  },
  "versions": [
    {
      "timestamp": 1672531200,
      "entries": [
        {"id": "A1", "labels": [0, 100],
         "max_lifetime": 7776000},
        {"id": "A2", "labels": [1, 100],
         "max_lifetime": 7776000},
        {"id": "B1", "labels": [2, 101],
         "max_lifetime": 7776000},
        {"id": "B2", "labels": [3, 101],
         "max_lifetime": 7776000}
      ]
    }
  ]
}
</pre><a href="#section-8-3" class="pilcrow">¶</a>
</div>
<p id="section-8-4">A certification path, A1_old, issued by A1, would have a TrustStoreInclusion:<a href="#section-8-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-5.1">
          <p id="section-8-5.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-5.2">
          <p id="section-8-5.2.1"><code>trust_store.version</code> is 0<a href="#section-8-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-5.3">
          <p id="section-8-5.3.1"><code>status</code> is <code>latest_version_at_issuance</code><a href="#section-8-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-5.4">
          <p id="section-8-5.4.1"><code>labels</code> is 0, 100<a href="#section-8-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-6">A certification path, B1_old, issued by B1, would have a TrustStoreInclusion:<a href="#section-8-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-7.1">
          <p id="section-8-7.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-7.2">
          <p id="section-8-7.2.1"><code>trust_store.version</code> is 0<a href="#section-8-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-7.3">
          <p id="section-8-7.3.1"><code>status</code> is <code>latest_version_at_issuance</code><a href="#section-8-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-7.4">
          <p id="section-8-7.4.1"><code>labels</code> is 2, 101<a href="#section-8-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-8">A certification path, C1_old, issued by C1, would have no TrustStoreInclusions that reference "example".<a href="#section-8-8" class="pilcrow">¶</a></p>
<p id="section-8-9">On February 1st, 2023, the root program added CAs C1 and C2 but removed CAs B1 and B2. It continues the previous label allocation scheme, but now wishes to allocate label 200 for CAs A1 and C1. The manifest may then be:<a href="#section-8-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-10">
<pre>
{
  "id": "32473.1",
  "max_age": 864000,
  "trust_anchors": {
    "A1": {"type": "x509", "data": "..."},
    "A2": {"type": "x509", "data": "..."},
    "B1": {"type": "x509", "data": "..."},
    "B2": {"type": "x509", "data": "..."},
    "C1": {"type": "x509", "data": "..."},
    "C2": {"type": "x509", "data": "..."}
  },
  "versions": [
    {
      "timestamp": 1672531200,
      "entries": [
        {"id": "A1", "labels": [0, 100],
         "max_lifetime": 7776000},
        {"id": "A2", "labels": [1, 100],
         "max_lifetime": 7776000},
        {"id": "B1", "labels": [2, 101],
         "max_lifetime": 7776000},
        {"id": "B2", "labels": [3, 101],
         "max_lifetime": 7776000}
      ]
    },
    {
      "timestamp": 1675209600,
      "entries": [
        {"id": "A1", "labels": [0, 100, 200],
         "max_lifetime": 7776000},
        {"id": "A2", "labels": [1, 100],
         "max_lifetime": 7776000},
        {"id": "C1", "labels": [4, 102, 200],
         "max_lifetime": 7776000},
        {"id": "C2", "labels": [5, 102],
         "max_lifetime": 7776000}
      ]
    }
  ]
}
</pre><a href="#section-8-10" class="pilcrow">¶</a>
</div>
<p id="section-8-11">A certification path, A1_new, newly issued by A1, would have two TrustStoreInclusions. The first:<a href="#section-8-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-12.1">
          <p id="section-8-12.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-12.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-12.2">
          <p id="section-8-12.2.1"><code>trust_store.version</code> is 0<a href="#section-8-12.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-12.3">
          <p id="section-8-12.3.1"><code>status</code> is <code>previous_version</code><a href="#section-8-12.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-12.4">
          <p id="section-8-12.4.1"><code>labels</code> is 0, 100<a href="#section-8-12.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-13">And the second:<a href="#section-8-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-14.1">
          <p id="section-8-14.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-14.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-14.2">
          <p id="section-8-14.2.1"><code>trust_store.version</code> is 1<a href="#section-8-14.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-14.3">
          <p id="section-8-14.3.1"><code>status</code> is <code>latest_version_at_issuance</code><a href="#section-8-14.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-14.4">
          <p id="section-8-14.4.1"><code>labels</code> is 0, 100, 200<a href="#section-8-14.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-15">A certification path, B1_new, newly issued by B1, would have a TrustStoreInclusion:<a href="#section-8-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-16.1">
          <p id="section-8-16.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-16.2">
          <p id="section-8-16.2.1"><code>trust_store.version</code> is 0<a href="#section-8-16.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-16.3">
          <p id="section-8-16.3.1"><code>status</code> is <code>previous_version</code><a href="#section-8-16.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-16.4">
          <p id="section-8-16.4.1"><code>labels</code> contains 2, 101<a href="#section-8-16.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-17">A certification path, C1_new, newly issued by C1, would have a TrustStoreInclusion:<a href="#section-8-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-18.1">
          <p id="section-8-18.1.1"><code>trust_store.id</code> is "32473.1"<a href="#section-8-18.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-18.2">
          <p id="section-8-18.2.1"><code>trust_store.version</code> is 1<a href="#section-8-18.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-18.3">
          <p id="section-8-18.3.1"><code>status</code> is <code>latest_version_at_issuance</code><a href="#section-8-18.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-18.4">
          <p id="section-8-18.4.1"><code>labels</code> contains 4, 102, 200<a href="#section-8-18.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-19">A relying party which trusts trust anchors A1, A2, B1, and B2 might send a TrustExpression referencing trust store "example", version 0, with empty <code>excluded_labels</code>. This would match A1_old, A1_new, B1_old, and B1_new by the corresponding TrustStoreInclusion. It would not match C1_old or C1_new.<a href="#section-8-19" class="pilcrow">¶</a></p>
<p id="section-8-20">A relying party which trusts trust anchors A2, B1, and B2, but not A1, might send a TrustExpression referencing trust store "example", version 0, with <code>excluded_labels</code> of 0. This would match B1_old and B1_new, but not A1_old or A1_new because the TrustExpression excludes A1.<a href="#section-8-20" class="pilcrow">¶</a></p>
<p id="section-8-21">A relying party which trusts trust anchors A1, A2, C1, and C2 might send a TrustExpression referencing trust store "example", version 1, with <code>excluded_labels</code> of 101. Although B1 and B2 are not contained in version 1 of the trust store, the relying party must exclude them, per <a href="#constructing-trust-expressions" class="auto internal xref">Section 6.5</a>. This TrustExpression matches the above certification paths as follows:<a href="#section-8-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-22.1">
          <p id="section-8-22.1.1">A1_old matches. Although it has no version 1 TrustStoreInclusion, the version 0 TrustStoreInclusion has a <code>status</code> of <code>latest_version_at_issuance</code>.<a href="#section-8-22.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-22.2">
          <p id="section-8-22.2.1">A1_new matches via its version 1 TrustStoreInclusion.<a href="#section-8-22.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-22.3">
          <p id="section-8-22.3.1">B1_old does not match. Although its version 0 TrustStoreInclusion has a <code>status</code> of <code>latest_version_at_issuance</code> and thus applies, <code>excluded_labels</code> excludes it.<a href="#section-8-22.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-22.4">
          <p id="section-8-22.4.1">B1_new does not match. Its version 0 TrustStoreInclusion has a <code>status</code> of <code>previous_version</code> and does not apply. It has no version 1 TrustStoreInclusion.<a href="#section-8-22.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-22.5">
          <p id="section-8-22.5.1">C1_old does not match. Although the relying party trusts C1, C1_old was issued before C1 was able to communicate this to the subscriber.<a href="#section-8-22.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-22.6">
          <p id="section-8-22.6.1">C1_new matches via its version 1 TrustStoreInclusion.<a href="#section-8-22.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-23">The relying party could equivalently have sent a TrustExpression referencing trust store "example", version 1, with <code>excluded_labels</code> of 2 and 3. This pair of labels excludes the same CAs as 101.<a href="#section-8-23" class="pilcrow">¶</a></p>
<p id="section-8-24">Of the above examples, B1_old depends on the exclusion to avoid a false positive match. 100 days after February 1st, B1 and B2's trust store entries from version 0 will expire (see <a href="#expiration" class="auto internal xref">Section 4.2</a>), and the relying party no longer needs to exclude them. By this point, B1_old will have expired. B1_new may still be valid, but it does not require the exclusion.<a href="#section-8-24" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-9">
      <h2 id="name-use-cases">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="key-rotation">
<section id="section-9.1">
        <h3 id="name-key-rotation">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-key-rotation" class="section-name selfRef">Key Rotation</a>
        </h3>
<p id="section-9.1-1">In most X.509 deployments, a compromise of <em>any</em> root CA's private key compromises the entire PKI. Yet key rotation in PKIs is rare. In 2023, the oldest root in <span>[<a href="#CHROME-ROOTS" class="cite xref">CHROME-ROOTS</a>]</span> and <span>[<a href="#MOZILLA-ROOTS" class="cite xref">MOZILLA-ROOTS</a>]</span> was 25 years old, dating to 1998. Key rotation is challenging in a single-certificate deployment model. As long as any older relying party requires the old root, subscribers cannot switch to the new root, which in turn means relying parties cannot distrust the old root, leaving them vulnerable.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">A multi-certificate deployment model avoids these transition problems. Key rotation may proceed as follows:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.1-3">
<li id="section-9.1-3.1">
            <p id="section-9.1-3.1.1">The CA operator generates a new root CA with a separate key, but continues operating the old root CA.<a href="#section-9.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-3.2">
            <p id="section-9.1-3.2.1">Root programs begin trusting the new root CA alongside the old one. They update their root store manifests.<a href="#section-9.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-3.3">
            <p id="section-9.1-3.3.1">When subscribers request certificates, the CA issues certificates from both roots and provisions the subscriber with both certificates.<a href="#section-9.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-3.4">
            <p id="section-9.1-3.4.1">Relying parties send trust expressions that evaluate to either the old or new root, and are served the appropriate option.<a href="#section-9.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-3.5">
            <p id="section-9.1-3.5.1">Once subscribers have been provisioned with new certificates, root programs can safely distrust the old root in new relying parties. The CA operator continues to operate the old root CA for as long as it wishes to serve subscribers that, in turn, wish to serve older relying parties.<a href="#section-9.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-9.1-4">This process requires no configuration changes to the subscriber, given an automated, multi-certificate-aware certificate issuance process. The subscriber does not need to know why it received two certificates, only how to select between them for each relying party.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="adding-cas">
<section id="section-9.2">
        <h3 id="name-adding-cas">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-adding-cas" class="section-name selfRef">Adding CAs</a>
        </h3>
<p id="section-9.2-1">In the single-certificate model, subscribers cannot use TLS certificates issued from a new root CA until all supported relying parties have been updated to trust the new root CA. This can take years or more. Some relying parties, such as IoT devices, may never receive trust store updates at all.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">As a result, it is very difficult for subscribers that serve a wide variety of relying parties to use a newly-trusted root CA. When trust stores diverge too far, subscribers often must partition their services into multiple TLS endpoints (i.e. different DNS names) and direct different relying parties to different endpoints. Subscribers sometimes resort to TLS fingerprinting, to detect particular relying parties. But, as this repurposes other TLS fields for unintended purposes, this is unreliable and usually requires writing custom service-specific logic.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">In a multi-certificate deployment model, subscribers can begin serving certificates from new root CAs without interrupting relying parties that depend on existing ones.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">In some contexts, it may be possible to use other fields to select the new CA. For example, post-quantum-capable clients may be detected with the <code>signature_algorithms</code> and <code>signature_algorithms_cert</code> extensions. However, this assumes all post-quantum CAs are added at the same time. A multi-certificate model avoids this problem and allows for a more gradual deployment of post-quantum CAs.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="removing-cas">
<section id="section-9.3">
        <h3 id="name-removing-cas">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-removing-cas" class="section-name selfRef">Removing CAs</a>
        </h3>
<p id="section-9.3-1">Subscribers in a single-certificate model are limited to CAs in the intersection of their supported relying parties. As newer relying parties remove untrusted CAs over time,the intersection with older relying parties shrinks. Moreover, the subscriber may not even know which CAs are in the intersection. Often, the only option is to try the new certificate and monitor errors. For subscribers that serve many diverse relying parties, this is a disruptive and risky process.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">The multi-certificate model removes this constraint. If a subscriber's CA is distrusted, it can continue to use that CA, in addition to a newer one. This removes the risk that some older relying party required that CA and was incompatible with the new one. The mechanisms in this document will select an appropriate certificate for each relying party.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-root-transitions">
<section id="section-9.4">
        <h3 id="name-other-root-transitions">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-other-root-transitions" class="section-name selfRef">Other Root Transitions</a>
        </h3>
<p id="section-9.4-1">The mechanisms in this document can aid PKI transitions beyond key rotation. For example, a CA operator may generate a postquantum root CA and use the mechanism in <a href="#acme-extension" class="auto internal xref">Section 7.1</a> to issue from the classical and postquantum roots concurrently. The subscriber will then, transparently and with no configuration change, serve both. As in <a href="#key-rotation" class="auto internal xref">Section 9.1</a>, newer relying parties can then remove the classical roots, while older relying parties continue to function.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">This same procedure may also be used to transition between newer, more size-efficient signature algorithms, as they are developed.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">[[TODO: There's one missing piece, which is that some servers may attempt to parse the signature algorithms out of the certificate chain. See https://github.com/davidben/tls-trust-expressions/issues/9 ]]<a href="#section-9.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediate-elision">
<section id="section-9.5">
        <h3 id="name-intermediate-elision">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-intermediate-elision" class="section-name selfRef">Intermediate Elision</a>
        </h3>
<p id="section-9.5-1">Today, root CAs typically issue shorter-lived intermediate certificates which, in turn, issue end-entity certificates. The long-lived root key is less exposed to attack, while the short-lived intermediate key can be more easily replaced without changes to relying parties.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2">This operational improvement comes at a bandwidth cost: the TLS handshake includes an extra certificate, which includes a public key, signature, and X.509 metadata. An average X.509 name in the Chrome Root Store <span>[<a href="#CHROME-ROOTS" class="cite xref">CHROME-ROOTS</a>]</span> or Mozilla CA Certificate Program <span>[<a href="#MOZILLA-ROOTS" class="cite xref">MOZILLA-ROOTS</a>]</span> is around 100 bytes alone. Post-quantum signature algorithms will dramatically shift this tradeoff. Dilithium3 <span>[<a href="#Dilithium" class="cite xref">Dilithium</a>]</span>, for example, has a total public key and signature size of 5,245 bytes.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
<p id="section-9.5-3"><span>[<a href="#I-D.ietf-tls-cert-abridge" class="cite xref">I-D.ietf-tls-cert-abridge</a>]</span> proposes to predistribute known intermediate certificates to relying parties, as a compression scheme. A multi-certificate deployment model provides another way to achieve this effect. To relying parties, a predistributed intermediate certificate is functionally equivalent to a root certificate. PKIs use intermediate certificates because changing root certificates requires updating relying parties, but predistributed intermediates already presume updated relying parties.<a href="#section-9.5-3" class="pilcrow">¶</a></p>
<p id="section-9.5-4">A CA operator could provide subscribers with two certification paths: a longer path ending at a long-lived trust anchor and shorter path the other ending at a short-lived, revocable root. Relying parties would be configured to trust both the long-lived root and the most recent short-lived root. The negotiation mechanism in <a href="#tls-certificate-negotiation" class="auto internal xref">Section 6</a> would then send the shorter path to up-to-date relying parties, and the longer path to older relying parties.<a href="#section-9.5-4" class="pilcrow">¶</a></p>
<p id="section-9.5-5">This achieves the same effect with a more general-purpose multi-certificate mechanism. It is also more flexible, as the two paths need not be related. For example, root CA public keys are not distributed in each TLS connection, so a post-quantum signature algorithm that optimizes for signature size may be preferable. In this model, both the long-lived and short-lived roots may use such an algorithm. In a compression-based model, the same intermediate must optimize both its compressed and uncompressed size, so such an algorithm may not be suitable.<a href="#section-9.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conflicting-relying-party-requirements">
<section id="section-9.6">
        <h3 id="name-conflicting-relying-party-r">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-conflicting-relying-party-r" class="section-name selfRef">Conflicting Relying Party Requirements</a>
        </h3>
<p id="section-9.6-1">A subscriber may need to support relying parties with different requirements. For example, in contexts where online revocation checks are expensive, unreliable, or privacy-sensitive, user security is best served by short-lived certificates. In other contexts, long-lived certificates may be more appropriate for, e.g., systems that are offline for long periods of time or have unreliable clocks.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">A single-certificate deployment model forces subscribers to find a single certificate that meets all requirements. User security then suffers in all contexts, as the PKI may not quite meet anyone's needs. In a multi-certificate deployment model, different contexts may use different trust anchors. A subscriber that supports multiple contexts would provision certificates for each, with certificate negotiation logic directing the right one to each relying party.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="backup-certificates">
<section id="section-9.7">
        <h3 id="name-backup-certificates">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-backup-certificates" class="section-name selfRef">Backup Certificates</a>
        </h3>
<p id="section-9.7-1">A subscriber may obtain certificate paths from multiple CAs for redundancy in the face of future CA compromises. If one CA is compromised and removed from newer relying parties, the TLS server software will transparently serve the other one.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">To support this, TLS serving software SHOULD permit users to configure multiple ACME endpoints and select from the union of the certificate paths returned by each ACME server.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">The negotiation mechanism described in this document is analogous to the <code>certificate_authorities</code> extension (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.4" class="relref">Section 4.2.4</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>), but more size-efficient. Like that extension, it presumes the advertised trust anchor list is not sensitive.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Thus, this mechanism SHOULD NOT be used to advertise trust anchors or distrusts which are unique to an individual user. Rather, trust expressions SHOULD be computed based only on the trust anchors common to the relying party's anonymity set (<span><a href="https://rfc-editor.org/rfc/rfc6973#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>). Additionally, multiple trust expressions may evaluate to the same trust anchor list, so relying parties in the same anonymity set SHOULD send the same trust expression. To achieve this, trust expressions SHOULD be assembled by the root program and configured in relying parties alongside trust store updates.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">For example, a web browser may support both a common set of trust anchors configured by a root program, along with user-specified additions and removals. Applying the above guidance with a typical browser's desired anonymity set, the trust expression would reflect only the common trust anchors and not the user-specified modifications. The user-specified modifications may reveal identifying information about the user, while the common trust anchors would reveal at most, e.g., which version of which browser is used, or even less information if multiple browsers share a root program or the trust anchors were unchanged across multiple versions of the browser.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">This guidance limits the benefits of trust anchor agility in two ways:<a href="#section-10-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-5.1">
          <p id="section-10-5.1.1">If a subscriber relies on a user-specified addition, the procedure in <a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a> will fallback to preexisting behavior, such as selecting a default certificate. The subscriber then relies on the default certificate matching the relying party.<a href="#section-10-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.2">
          <p id="section-10-5.2.1">If a subscriber has a certificate issued by a CA distrusted by the user, the procedure in <a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a> may select a distrusted certificate. In that case, the connection will fail, even if the subscriber has another certificate available.<a href="#section-10-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-6">Both of these cases match the preexisting behavior in PKIs that do not use trust expressions.<a href="#section-10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="relying-party-policies-and-agility">
<section id="section-11.1">
        <h3 id="name-relying-party-policies-and-">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-relying-party-policies-and-" class="section-name selfRef">Relying Party Policies and Agility</a>
        </h3>
<p id="section-11.1-1">The certificate negotiation mechanism described in this document facilitates which certification path is served to relying parties, but has no impact on the relying party's trust preferences themselves.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">As a result, this allows for a more flexible and agile PKI, which can better mitigate security risks to users. <a href="#use-cases" class="auto internal xref">Section 9</a> discusses some scenarios which benefit from the multi-certificate deployment this document enables. In general, robust certificate negotiation helps subscribers navigate differences in relying party requirements. This means security improvements for one set of relying parties can be deployed without needing to risk incompatibility or breakage for others.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">For example, agility reduces pressures on relying parties to sacrifice user security for compatibility. Suppose a subscriber currently uses some CA, but a relying party deems trusting that CA to pose an unacceptable security risk to its users. In a single-certificate deployment, those subscribers may be unwilling to adopt a CA trusted by the relying party, as switching CAs risks compatibility problems elsewhere. The relying party then faces compatibility pressure add this CA, sacrificing user security. However, in a multi-certificate deployment, the subscriber can use its existing CA <em>in addition to</em> another CA trusted by relying party B. This allows the ecosystem to improve interoperability, while still meeting relying party B's user-security goals.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="incorrect-selection-metadata">
<section id="section-11.2">
        <h3 id="name-incorrect-selection-metadat">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-incorrect-selection-metadat" class="section-name selfRef">Incorrect Selection Metadata</a>
        </h3>
<p id="section-11.2-1">If either the subscriber's TrustStoreInclusionList or the relying party's TrustExpressionList are incorrect, the matching algorithm described in <a href="#subscriber-behavior" class="auto internal xref">Section 6.4</a> may incorrectly identify an untrusted certification path. This mechanism will not result in that path being trusted, but does present the possibility of a denial of service. These structures are provisioned by the CA and root program, respectively, who are already expected to provide accurate information.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serving-multiple-certificates">
<section id="section-11.3">
        <h3 id="name-serving-multiple-certificat">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-serving-multiple-certificat" class="section-name selfRef">Serving Multiple Certificates</a>
        </h3>
<p id="section-11.3-1">In a multi-certificate deployment, subscribers have a collection of certificates available to satisfy relying parties with potentially different security policies. It is possible that some of these policies will only be satisifed by certificates from less trustworthy CAs, such as if the relying party is out of date but still important for the subscriber to support. If a certificate asserts the correct information about the subscriber (TLS key, DNS names, etc.), the subscriber can safely present it, even if the CA is otherwise untrustworthy. Issuing a certificate for the subscriber's public key does not grant the CA access to the corresponding private key. Presenting such a certificate does not enable the CA decrypt or intercept the connection.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">However, the subscriber presenting a certificate is not an endorsement of the CA. The subscriber's role is to present a certificate which will convince the relying party of the correct subscriber information. Subscribers do not vet CAs for trustworthiness, only the correctness of their specific, configured certificates and the CA's ability to meet the subscriber's requirements, such as availability, compatibility, and performance. It is the responsibility of the relying party, and its corresponding root program, to determine the set of trusted CAs. Trusting a CA means trusting <em>all</em> certificates issued by that CA, so it is not enough to observe subscribers serving correct certificates. An untrustworthy CA may sign one correct certificate, but also sign incorrect certificates, possibly in the future, that can attack the relying party. Root program management is a complex, security-critical process, the full considerations of which are outside the scope of this document.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="targeting-tls-interception">
<section id="section-11.4">
        <h3 id="name-targeting-tls-interception">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-targeting-tls-interception" class="section-name selfRef">Targeting TLS Interception</a>
        </h3>
<p id="section-11.4-1">Trust Expressions, like <code>certificate_authorities</code>, enables a TLS server to differentiate between clients that do and do not trust some CA. If this CA mis-issued a certificate, this could be used by a network attacker to only enable TLS interception with clients that trust the CA. The network attacker may wish to do this reduce the odds of detection. Clients which do not trust the CA will not accept the mis-issued certificate, which may be user-visible.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">However, the attacker could also use any existing mechanism for differentiating clients. In TLS parameter negotiation, the client offers all its available TLS features, including cipher suites and other extensions, in the TLS ClientHello. This means any variation in any client TLS policies, related or unrelated to trust anchors, may be used as an implementation fingerprint to differentiate clients. While fingerprinting's heuristic nature makes it not viable for a broad, diverse set of TLS servers, it is viable for a network attacker's single interception service. Trust Expressions only impacts detection where this differentiation was not already possible.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">If the attacker targets any clients that enforce Certificate Transparency <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span>, the mis-issued certificates will need to be publicly logged. In this case, detection is more robust, and client differentiation, with or without Trust Expressions, has no significant impact.<a href="#section-11.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-extensiontype-updates">
<section id="section-12.1">
        <h3 id="name-tls-extensiontype-updates">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-tls-extensiontype-updates" class="section-name selfRef">TLS ExtensionType Updates</a>
        </h3>
<p id="section-12.1-1">IANA is requested to create the following entry in the TLS ExtensionType Values registry, defined by <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">trust_expressions</td>
              <td class="text-left" rowspan="1" colspan="1">CH, CR, CT</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">[this-RFC]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="media-type-updates">
<section id="section-12.2">
        <h3 id="name-media-type-updates">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-media-type-updates" class="section-name selfRef">Media Type Updates</a>
        </h3>
<p id="section-12.2-1">IANA is requested to create the following entry in the "Media Types" registry, defined in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12.2-2">
          <dt id="section-12.2-2.1">Type name:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.2">
            <p id="section-12.2-2.2.1">application<a href="#section-12.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.3">Subtype name:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.4">
            <p id="section-12.2-2.4.1">pem-certificate-chain-with-properties<a href="#section-12.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.5">Required parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.6">
            <p id="section-12.2-2.6.1">None<a href="#section-12.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.7">Optional parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.8">
            <p id="section-12.2-2.8.1">None<a href="#section-12.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.9">Encoding considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.10">
            <p id="section-12.2-2.10.1">7bit<a href="#section-12.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.11">Security considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.12">
            <p id="section-12.2-2.12.1">Carries a cryptographic certificate and its associated certificate chain and additional properties. This media type carries no active content.<a href="#section-12.2-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.13">Interoperability considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.14">
            <p id="section-12.2-2.14.1">None<a href="#section-12.2-2.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.15">Published specification:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.16">
            <p id="section-12.2-2.16.1">[this-RFC, <a href="#media-type" class="auto internal xref">Section 5.3</a>]<a href="#section-12.2-2.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.17">Applications that use this media type:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.18">
            <p id="section-12.2-2.18.1">ACME clients and servers, HTTP servers, other applications that need to be configured with a certificate chain<a href="#section-12.2-2.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.19">Additional information:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.20">
            <span class="break"></span><dl class="dlCompact dlParallel" id="section-12.2-2.20.1">
              <dt id="section-12.2-2.20.1.1">Deprecated alias names for this type:</dt>
              <dd style="margin-left: 1.5em" id="section-12.2-2.20.1.2">n/a<a href="#section-12.2-2.20.1.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2-2.20.1.3">Magic number(s):</dt>
              <dd style="margin-left: 1.5em" id="section-12.2-2.20.1.4">n/a<a href="#section-12.2-2.20.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2-2.20.1.5">File extension(s):</dt>
              <dd style="margin-left: 1.5em" id="section-12.2-2.20.1.6">.pem<a href="#section-12.2-2.20.1.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-12.2-2.20.1.7">Macintosh file type code(s):</dt>
              <dd style="margin-left: 1.5em" id="section-12.2-2.20.1.8">n/a<a href="#section-12.2-2.20.1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.21">Person &amp; email address to contact for further information:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.22">
            <p id="section-12.2-2.22.1">See Authors' Addresses section.<a href="#section-12.2-2.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.23">Intended usage:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.24">
            <p id="section-12.2-2.24.1">COMMON<a href="#section-12.2-2.24.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.25">Restrictions on usage:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.26">
            <p id="section-12.2-2.26.1">n/a<a href="#section-12.2-2.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.27">Author:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.28">
            <p id="section-12.2-2.28.1">See Authors' Addresses section.<a href="#section-12.2-2.28.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-12.2-2.29">Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-12.2-2.30">
            <p id="section-12.2-2.30.1">IETF<a href="#section-12.2-2.30.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="certificatepropertytype-registry">
<section id="section-12.3">
        <h3 id="name-certificatepropertytype-reg">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-certificatepropertytype-reg" class="section-name selfRef">CertificatePropertyType Registry</a>
        </h3>
<p id="section-12.3-1">[[TODO: Establish a CertificatePropertyType registry.]]<a href="#section-12.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="POSIX">[POSIX]</dt>
        <dd>
<span class="refTitle">"IEEE Standard for Information Technology--Portable Operating System Interface (POSIX(TM)) Base Specifications, Issue 7"</span>, <span class="refContent">IEEE</span>, <span class="seriesInfo">DOI 10.1109/ieeestd.2018.8277153</span>, <span class="seriesInfo">ISBN ["9781504445429"]</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://doi.org/10.1109/ieeestd.2018.8277153">https://doi.org/10.1109/ieeestd.2018.8277153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4158">[RFC4158]</dt>
        <dd>
<span class="refAuthor">Cooper, M.</span>, <span class="refAuthor">Dzambasow, Y.</span>, <span class="refAuthor">Hesse, P.</span>, <span class="refAuthor">Joseph, S.</span>, and <span class="refAuthor">R. Nicholas</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure: Certification Path Building"</span>, <span class="seriesInfo">RFC 4158</span>, <span class="seriesInfo">DOI 10.17487/RFC4158</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4158">https://www.rfc-editor.org/rfc/rfc4158</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6973">https://www.rfc-editor.org/rfc/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7468">[RFC7468]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">S. Leonard</span>, <span class="refTitle">"Textual Encodings of PKIX, PKCS, and CMS Structures"</span>, <span class="seriesInfo">RFC 7468</span>, <span class="seriesInfo">DOI 10.17487/RFC7468</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7468">https://www.rfc-editor.org/rfc/rfc7468</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9371">[RFC9371]</dt>
        <dd>
<span class="refAuthor">Baber, A.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Registration Procedures for Private Enterprise Numbers (PENs)"</span>, <span class="seriesInfo">RFC 9371</span>, <span class="seriesInfo">DOI 10.17487/RFC9371</span>, <time datetime="2023-03" class="refDate">March 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9371">https://www.rfc-editor.org/rfc/rfc9371</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X680">[X680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time datetime="2021" class="refDate">2021</time>. </dd>
<dd class="break"></dd>
<dt id="X690">[X690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time datetime="2021" class="refDate">2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CCADB">[CCADB]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refAuthor">Microsoft</span>, <span class="refAuthor">Google</span>, <span class="refAuthor">Apple</span>, and <span class="refAuthor">Cisco</span>, <span class="refTitle">"Common CA Database"</span>, <time datetime="2023-10-09" class="refDate">9 October 2023</time>, <span>&lt;<a href="https://www.ccadb.org/">https://www.ccadb.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHROME-ROOTS">[CHROME-ROOTS]</dt>
        <dd>
<span class="refAuthor">Chromium</span>, <span class="refTitle">"Chrome Root Store"</span>, <time datetime="2023-08-30" class="refDate">30 August 2023</time>, <span>&lt;<a href="https://chromium.googlesource.com/chromium/src/+/main/net/data/ssl/chrome_root_store">https://chromium.googlesource.com/chromium/src/+/main/net/data/ssl/chrome_root_store</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Dilithium">[Dilithium]</dt>
        <dd>
<span class="refAuthor">Bai, S.</span>, <span class="refAuthor">Ducas, L.</span>, <span class="refAuthor">Kiltz, E.</span>, <span class="refAuthor">Lepoint, T.</span>, <span class="refAuthor">Lyubashevsky, V.</span>, <span class="refAuthor">Schwabe, P.</span>, <span class="refAuthor">Seiler, G.</span>, and <span class="refAuthor">D. Stehlé</span>, <span class="refTitle">"CRYSTALS-Dilithium Algorithm Specifications and Supporting Documentation"</span>, <time datetime="2021-02-08" class="refDate">8 February 2021</time>, <span>&lt;<a href="https://pq-crystals.org/dilithium/data/dilithium-specification-round3-20210208.pdf">https://pq-crystals.org/dilithium/data/dilithium-specification-round3-20210208.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-cert-abridge">[I-D.ietf-tls-cert-abridge]</dt>
        <dd>
<span class="refAuthor">Jackson, D.</span>, <span class="refTitle">"Abridged Compression for WebPKI Certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-cert-abridge-01</span>, <time datetime="2024-03-16" class="refDate">16 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-cert-abridge-01">https://datatracker.ietf.org/doc/html/draft-ietf-tls-cert-abridge-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MOZILLA-ROOTS">[MOZILLA-ROOTS]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refTitle">"Mozilla Included CA Certificate List"</span>, <time datetime="2023-08-30" class="refDate">30 August 2023</time>, <span>&lt;<a href="https://wiki.mozilla.org/CA/Included_Certificates">https://wiki.mozilla.org/CA/Included_Certificates</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6066">https://www.rfc-editor.org/rfc/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6962">[RFC6962]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Kasper</span>, <span class="refTitle">"Certificate Transparency"</span>, <span class="seriesInfo">RFC 6962</span>, <span class="seriesInfo">DOI 10.17487/RFC6962</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6962">https://www.rfc-editor.org/rfc/rfc6962</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="cddl-schema">
<section id="appendix-A">
      <h2 id="name-cddl-schema">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-cddl-schema" class="section-name selfRef">CDDL Schema</a>
      </h2>
<p id="appendix-A-1">The following is a non-normative CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> schema which describes a trust store manifest structure (<a href="#trust-store-manifests" class="auto internal xref">Section 4</a>):<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>
trust-anchor = {
    type: text,
    * text =&gt; any,
}

trust-store-entry = {
    trust_anchor: text,
    labels: [+ uint],
    max_lifetime: uint,
    * text =&gt; any,
}

trust-store-version = {
    timestamp: int,
    entries: [+ trust-store-entry],
    * text =&gt; any,
}

trust-store-manifest = {
    id: text,
    max_age: uint,
    trust_anchors: {+ text =&gt; trust-anchor},
    versions: [+ trust-store-version],
    * text =&gt; any,
}
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors thank Nick Harper, Sophie Schmieg, and Emily Stark for many valuable discussions and insights which led to this document, as well as review of early iterations.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Benjamin</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davidben@google.com" class="email">davidben@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Devon O'Brien</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:asymmetric@google.com" class="email">asymmetric@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bob Beck</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bbe@google.com" class="email">bbe@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
